(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{114:function(e,t){},120:function(e,t){},123:function(e,t,a){},124:function(e,t,a){},126:function(e,t,a){},135:function(e,t,a){},136:function(e,t,a){},140:function(e,t,a){},141:function(e,t,a){},189:function(e,t,a){},191:function(e,t,a){},226:function(e,t,a){},227:function(e,t,a){},228:function(e,t,a){},229:function(e,t,a){},230:function(e,t,a){"use strict";a.r(t);var i,s=a(0),n=a.n(s),r=a(7),o=a.n(r),p=(a(99),a(5)),l=a(72),c=a(30),d=a(1),m=e=>{var t=P(e);return null!=t?m(t):e},h=e=>{var t=P(e);return null!=t&&t.parties},u=e=>{var t=P(e);return null!=t&&t.groups},g=e=>{var t=P(e);return null!=t&&t.candidates},f=(e,t)=>{0===t.filter(t=>t===e).length&&t.push(e);var a=P(e);!a.votingPaper||u(a)&&a.votingPaper.disjointed||f(a,t)},v=(e,t,a)=>{var i=a.slice(0,t),s=a.slice(t);return i.concat(e,s)},b=()=>{var e=null;return Oe.votingPapers.forEach(t=>{t.id>e&&(e=t.id),t.groups&&t.groups.forEach(t=>{t.id>e&&(e=t.id),t.parties&&t.parties.forEach(t=>{t.id>e&&(e=t.id),t.candidates&&t.candidates.forEach(t=>{t.id>e&&(e=t.id)})})}),t.parties&&t.parties.forEach(t=>{t.id>e&&(e=t.id),t.candidates&&t.candidates.forEach(t=>{t.id>e&&(e=t.id)})})}),e+1},y=e=>o.a.findDOMNode(e).querySelectorAll(".p-menuitem-link"),E=e=>{var t=y(e);return Oe&&Oe.votingPapers.forEach((e,a)=>{t[a].className.includes(e.type)||(t[a].className=t[a].className+" App-"+e.id+" "+e.type),t[a].style.setProperty("background-color","#"+e.color),t[a].style.setProperty("border-color","#"+e.color)}),t},C=(e,t)=>{var a=t.state.items.map(e=>e.id).indexOf(e.id);if(t.state.activeItem.id===e.id){var i=y(t);0!==a?i[0].click():i[1].click()}t.state.items.splice(a,1),Oe.votingPapers.splice(a,1),t.forceUpdate()},x=(e,t)=>{if(0===t.filter(t=>P(t)===e).length||u(e)&&e.votingPaper.disjointed){var a=t.indexOf(e);t.splice(a,1);var i=P(e);!i.votingPaper||u(i)&&i.votingPaper.disjointed||i.selected||g(e)&&0!==t.filter(e=>g(e)&&P(e)===i).length||x(i,t)}},P=e=>{var t=null;return Oe.votingPapers.forEach(a=>{a!==e&&(a.groups?a.groups.forEach(i=>{i===e?t=a:i.parties&&i.parties.forEach(a=>{a===e?t=i:a.candidates&&a.candidates.forEach(i=>{i===e&&(t=a)})})}):a.parties&&a.parties.forEach(i=>{i===e?t=a:i.candidates&&i.candidates.forEach(a=>{a===e&&(t=i)})}))}),t},S=(e,t)=>{var a=new FileReader;a.onload=function(){t.setState({image:a.result.replace(/^data:.+;base64,/,"")}),t.forceUpdate()};var i=new XMLHttpRequest;i.open("GET",e,!0),i.responseType="blob",i.onload=function(){200===this.status&&a.readAsDataURL(this.response)},i.send()},N=e=>{for(var t=atob(e.image),a=new Array(t.length),i=0;i<t.length;i++)a[i]=t.charCodeAt(i);var s=new Uint8Array(a),n=new Blob([s],{type:"image/jpeg"});return new File([n],e.name,{type:"image/jpeg"})},k="M",w="F",M=e=>{var t=e.value.votingPaper,a=I.filter(e=>e.votingPaper===t);if(e.value.type===ee){var s=a.filter(e=>e.type===ee);return!!(e.value.selected||s.length<1||1===s.filter(t=>t===e.value).length)||(i({name:e.value.name,type:n.a.createElement(d.a,{id:"app.error.group",defaultMessage:"the "+ee})}),!1)}if(e.value.type===te){var r=P(e.value),o=a.filter(e=>P(e)===r&&e.type===te),p=a.map(e=>e.type===te?P(e):null).filter((e,t,a)=>a.indexOf(e)===t&&e),l=a.filter(t=>t.type===j&&P(t)===e.value).length>0;return!!(e.value.selected||l||o.length<1&&p.length<1&&(t.disjointed||a.filter(e=>e===r).length>0||0===a.length))||(i({name:e.value.name,type:n.a.createElement(d.a,{id:"app.error.party",defaultMessage:"the "+te})}),!1)}var c=P(e.value),m=a.filter(e=>e.type===j).filter(e=>P(e)===c),h=a.filter(e=>e.type===te),u=h.filter(t=>t===P(e.value)),g=h.filter(t=>t!==P(e.value)),f=a.filter(e=>e===c||e===P(c));return!(!(!t.disjointed&&(f.length>0||0===a.length)||t.disjointed&&(1===u.length||0===g.length))||!_(m,e.value))||(i({name:e.value.name,type:n.a.createElement(d.a,{id:"app.error.candidate",defaultMessage:"the "+j})}),!1)},_=(e,t)=>{var a=0,i=0,s=e.filter(e=>e!==t),n=s.length;return t.selected||(t.sex===k&&a++,t.sex===w&&i++,n++),s.forEach(e=>{e.sex===k&&a++,e.sex===w&&i++}),Math.round(n/2)>=a&&Math.round(n/2)>=i},I=[];class T extends s.Component{constructor(){super(),i=this.errors.bind(this)}errors(e){var t={severity:"error",summary:n.a.createElement(d.a,{id:"app.error",defaultMessage:"Error"}),detail:n.a.createElement(d.a,{id:"app.error.message",defaultMessage:"Unable to select {type} {value}",values:{type:e.type,value:e.name}})};this.growl.show(t)}render(){return n.a.createElement(c.Growl,{ref:e=>this.growl=e})}}a(123);var H,j="candidate";class U extends s.Component{constructor(){super(),this.state={filteredCandidates:null},this.filterCandidates=this.filterCandidates.bind(this),this.chosenCandidates=[]}filterCandidates(e){setTimeout(()=>{var t;t=0===e.query.length?this.props.config.filter(e=>!this.chosenCandidates.find(t=>t===e.name)):this.props.config.filter(t=>!this.chosenCandidates.find(e=>e===t.name)&&t.name.toLowerCase().startsWith(e.query.toLowerCase())),this.setState({filteredCandidates:t})},250)}itemTemplate(e){var t;return e.type=j,e.votingPaper=m(e),e.image&&(t=n.a.createElement("img",{className:"excludeSelect",alt:e.name,src:"data:image/jpeg;base64,".concat(e.image),style:{width:"32px",display:"inline-block",margin:"5px 0 2px 5px"}})),n.a.createElement("div",{className:"p-clearfix excludeSelect"},t,n.a.createElement("div",{className:"excludeSelect",style:{fontSize:"16px"}},e.name))}onDropdownClick(e,t){this.refs["autocomplete-candidate-"+t].onDropdownClick(e),e.stopPropagation()}onUnselect(e,t){if(8===e.nativeEvent.keyCode&&H.selected){this.setState((function(){var e={};return e[j+t]=H.name,e}))}}onAutocompleteChange(e,t){var a=e.value.name;e.value.id&&(M(e)?(f(e.value,I),e.value.selected=!0):a=" _________________________");var i=this.state[j+t];if(i&&(H=this.props.config.filter(e=>e.name===i)[0])&&M({value:H})){var s=this.chosenCandidates.indexOf(i);this.chosenCandidates.splice(s,1),this.props.config.forEach(e=>{e.name===i&&(e.selected=!1,x(e,I))})}this.setState((function(){var e={};return e[j+t]=a,this.chosenCandidates.push(a),e}))}render(){var e=this,t=[];if(this.props.config.length>0)for(var a=function(a){t.push(n.a.createElement(l.AutoComplete,{className:"excludeSelect",key:"autocomplete-"+j+"-"+a,ref:"autocomplete-"+j+"-"+a,onClick:t=>{e.onDropdownClick(t,a)},value:e.state[j+a],suggestions:e.state.filteredCandidates,completeMethod:e.filterCandidates,size:30,minLength:1,placeholder:a+1+" _________________________",itemTemplate:e.itemTemplate.bind(e),selectedItemTemplate:e=>a+1+" "+e,onChange:t=>e.onAutocompleteChange(t,a),onKeyUp:t=>e.onUnselect(t,a)}))},i=0;i<this.props.maxcandidates;i++)a(i);return n.a.createElement("div",{className:"candidates"},t)}}var B=a(3),L=a.n(B),D=(a(124),a(12)),O=a(18),A=(a(35),a(126),a(31));class R extends A.FileUpload{onFileSelect(e){super.onFileSelect(e),this.state.files.length>1&&this.state.files.shift()}remove(e){super.remove(e),this.props.party.setState({image:""})}validate(e){if(this.props.maxFileSize&&e.size>this.props.maxFileSize){var t={severity:"error",summary:n.a.createElement(d.a,{id:"app.admin.error.file.summary",defaultMessage:this.props.invalidFileSizeMessageSummary,values:{0:e.name}}),detail:n.a.createElement(d.a,{id:"app.admin.error.file.detail",defaultMessage:this.props.invalidFileSizeMessageDetail,values:{0:this.formatSize(this.props.maxFileSize)}})};return"advanced"===this.props.mode&&this.messagesUI.show(t),this.props.onValidationFail&&this.props.onValidationFail(e),!1}return!0}componentDidUpdate(){if(this.props.party.state.opened){var e=this.props.party.props.party;e&&e.image?this.onFileSelect({target:{files:[N(e)]}}):this.state.files.pop(),this.props.party.setState({opened:!1}),"insert"!==this.props.party.state.operation||this.props.party.state.image||this.state.files.pop()}}}var z,F=e=>e&&e.name?!(!e||e.name.length>40)||(z({name:"name",message:n.a.createElement(d.a,{id:"app.admin.error.maxname",defaultMessage:"You can specify a maximum length of {number} characters for the name",values:{number:40}})}),!1):(z({name:"name",message:n.a.createElement(d.a,{id:"app.admin.error.party.name",defaultMessage:"The name of the party is mandatory"})}),!1),G=(e,t)=>e&&e.name?e&&e.sex?!e||e.name.length>40?(z({name:"name",message:n.a.createElement(d.a,{id:"app.admin.error.maxname",defaultMessage:"You can specify a maximum length of {number} characters for the name",values:{number:40}})}),!1):!e||t.filter(t=>t.name.toUpperCase()===e.name.toUpperCase()&&t.id!==e.id).length>0?(z({name:"name",message:n.a.createElement(d.a,{id:"app.admin.error.candidate.existingname",defaultMessage:"The name of the candidate already exists"})}),!1):!e||e.image&&t.filter(t=>t.image===e.image&&t.id!==e.id).length>0?(z({name:"image",message:n.a.createElement(d.a,{id:"app.admin.error.candidate.existingimage",defaultMessage:"The image of the candidate already exists"})}),!1):!(!e||e.name.length<6||!e.name.includes(" "))||(z({name:"name",message:n.a.createElement(d.a,{id:"app.admin.error.candidate.surname",defaultMessage:"Insert name and surname please"})}),!1):(z({name:"sex",message:n.a.createElement(d.a,{id:"app.admin.error.candidate.sex",defaultMessage:"The sex of the candidate is mandatory"})}),!1):(z({name:"name",message:n.a.createElement(d.a,{id:"app.admin.error.candidate.name",defaultMessage:"The name of the candidate is mandatory"})}),!1);class W extends s.Component{constructor(){super(),z=this.errors.bind(this)}errors(e){var t={severity:"error",summary:n.a.createElement(d.a,{id:"app.error",defaultMessage:"Error"}),detail:e.message};this.growl.show(t)}render(){return n.a.createElement(c.Growl,{ref:e=>this.growl=e})}}class V extends s.Component{constructor(){super(),this.state={partyName:"",partyTitle:"",image:"",operation:"",opened:!1},this.state.configurationHeader=n.a.createElement(d.a,{id:"app.configuration.headerparty",defaultMessage:"Configure your Party"}),this.state.configurationGroupHeader=n.a.createElement(d.a,{id:"app.configuration.headergroup",defaultMessage:"Configure your Group"}),this.state.configurationInsertPartyHeader=n.a.createElement(d.a,{id:"app.configuration.headerinsertparty",defaultMessage:"Insert your Party"}),this.state.configurationInsertGroupHeader=n.a.createElement(d.a,{id:"app.configuration.headerinsertgroup",defaultMessage:"Insert your Group"}),this.state.name=n.a.createElement(d.a,{id:"app.configuration.name",defaultMessage:"Name"}),this.state.title=n.a.createElement(d.a,{id:"app.configuration.title",defaultMessage:"Title"}),this.state.chooseImage=n.a.createElement(d.a,{id:"app.configuration.chooseimage",defaultMessage:"Choose Image"}),this.open=this.open.bind(this),this.confirm=this.confirm.bind(this),this.delete=this.delete.bind(this),this.onHide=this.onHide.bind(this),this.onSelect=this.onSelect.bind(this)}componentDidUpdate(){"insert"!==this.state.operation||this.state.partyName||this.name.element.focus()}open(){this.setState({visible:!0})}confirm(){var e,t={name:this.state.partyName,subtitle:this.state.partyTitle,image:this.state.image};if("update"===this.state.operation)(h(this.props.party)&&F(t)||u(this.props.party)&&((e=t)&&e.name?e&&!(e.name.length>40)||(z({name:"name",message:n.a.createElement(d.a,{id:"app.admin.error.maxname",defaultMessage:"You can specify a maximum length of {number} characters for the name",values:{number:40}})}),0):(z({name:"name",message:n.a.createElement(d.a,{id:"app.admin.error.group.name",defaultMessage:"The name of the group is mandatory"})}),0)))&&(this.props.party.name=t.name,this.props.party.subtitle=t.subtitle,this.props.party.image=t.image,this.setState({visible:!1}),this.props.votingPaper.forceUpdate());else if(F(t)){var a=b();t.id=a,this.props.party.name?this.props.party.parties.push(t):this.props.party.votingPaper.groups?(t.parties=[],this.props.party.votingPaper.groups.push(t)):this.props.party.votingPaper.parties.push(t),this.setState({visible:!1}),this.props.votingPaper.forceUpdate()}}delete(){var e=P(this.props.party);if(h(this.props.party)){var t=e.parties.map(e=>e.id).indexOf(this.props.party.id);e.parties.splice(t,1)}else{var a=e.groups.map(e=>e.id).indexOf(this.props.party.id);e.groups.splice(a,1)}this.setState({visible:!1}),this.props.votingPaper.forceUpdate()}onHide(){this.setState({visible:!1})}onSelect(e){e.files[0].objectURL&&S(e.files[0].objectURL,this)}render(){var e="";this.props.party&&"update"===this.state.operation&&(e=n.a.createElement(d.a,{id:"app.delete",defaultMessage:"Delete"},e=>n.a.createElement(p.Button,{label:e,icon:"pi pi-check",onClick:this.delete,className:"confirm"})));var t=n.a.createElement("div",null,n.a.createElement(d.a,{id:"app.confirm",defaultMessage:"Confirm"},e=>n.a.createElement(p.Button,{label:e,icon:"pi pi-check",onClick:this.confirm,className:"confirm"})),e,n.a.createElement(d.a,{id:"app.cancel",defaultMessage:"Cancel"},e=>n.a.createElement(p.Button,{label:e,icon:"pi pi-times",onClick:this.onHide,className:"p-button-secondary confirm"}))),a="";return a=h(this.props.party)?"update"===this.state.operation?this.state.configurationHeader:this.state.configurationInsertHeader:"update"===this.state.operation?this.state.configurationGroupHeader:this.props.party.name||"little-nogroup"===this.props.party.votingPaper.type?this.state.configurationInsertPartyHeader:this.state.configurationInsertGroupHeader,n.a.createElement(D.Dialog,{contentStyle:{maxHeight:"600px",width:"360px"},header:a,visible:this.state.visible,footer:t,onHide:this.onHide,className:"modal-party"},n.a.createElement("div",{className:"p-grid"},n.a.createElement("div",{className:"p-col"},this.state.name),n.a.createElement("div",{className:"p-col"},n.a.createElement(O.InputText,{ref:e=>{this.name=e},value:this.state.partyName,onChange:e=>this.setState({partyName:e.target.value}),onKeyPress:e=>{13===e.nativeEvent.keyCode&&this.confirm()}}))),n.a.createElement("div",{className:"p-grid"},n.a.createElement("div",{className:"p-col"},this.state.title),n.a.createElement("div",{className:"p-col"},n.a.createElement(O.InputText,{ref:e=>{this.title=e},value:this.state.partyTitle?this.state.partyTitle:"",onChange:e=>this.setState({partyTitle:e.target.value})}))),n.a.createElement("div",{className:"p-grid"},n.a.createElement("div",{className:"p-col"},n.a.createElement(d.a,{id:"app.configuration.chooseimage",defaultMessage:"Choose Image"},e=>n.a.createElement(R,{accept:"image/*",maxFileSize:6e4,onSelect:this.onSelect,chooseLabel:e,party:this,previewWidth:150})))))}}var Y=a(40),q=a(32);a(135);class J extends A.FileUpload{onFileSelect(e){super.onFileSelect(e),this.state.files.length>1&&this.state.files.shift()}remove(e){super.remove(e),this.props.party.setState({image:""})}componentDidUpdate(){if(this.props.party.state.opened){var e=this.props.candidate;e&&e.image?this.onFileSelect({target:{files:[N(e)]}}):this.state.files.pop(),this.props.party.setState({opened:!1}),"insert"!==this.props.party.state.operation||this.props.party.state.image||this.state.files.pop()}}}var K=Object(s.createRef)("candidateUpload");class X extends s.Component{constructor(e){super(e),this.state={id:"",name:"",sex:"",image:"",candidate:{},candidates:[],generateId:"",opened:!1},this.state.configurationHeader=n.a.createElement(d.a,{id:"app.configuration.headercandidates",defaultMessage:"Manage candidates"}),this.state.namesurnameLabel=n.a.createElement(d.a,{id:"app.configuration.namesurname",defaultMessage:"Name and surname"}),this.state.genderLabel=n.a.createElement(d.a,{id:"app.configuration.gender",defaultMessage:"Gender"}),this.state.chooseImage=n.a.createElement(d.a,{id:"app.configuration.chooseimage",defaultMessage:"Choose Image"}),this.open=this.open.bind(this),this.confirm=this.confirm.bind(this),this.onHide=this.onHide.bind(this),this.onSelect=this.onSelect.bind(this),this.imgTemplate=this.imgTemplate.bind(this)}open(){var e=this.props.party,t=[];e.candidates&&e.candidates.forEach(e=>{t.push({label:e.name,value:e.id,id:e.id,name:e.name,image:e.image,sex:e.sex})}),this.setState({id:"",sex:"",image:"",name:"",candidates:t,visible:!0})}confirm(){this.props.party.candidates=this.state.candidates,this.props.partyComponent.forceUpdate(),this.setState({visible:!1})}onHide(){this.setState({visible:!1})}onSelect(e){e.files[0].objectURL&&S(e.files[0].objectURL,this)}imgTemplate(e){var t=this.state.candidates.filter(t=>t.id===parseInt(e.value))[0].image;return n.a.createElement("div",{className:"p-clearfix"},n.a.createElement("img",{alt:e.label,src:"data:image/jpeg;base64,".concat(t),style:{display:"inline-block",margin:"5px 0 0 5px",width:48}}),n.a.createElement("span",{style:{fontSize:"1.3em",float:"right",margin:"1em .5em 0 0"}},e.label))}render(){var e=this.state.candidates.filter(e=>e.id===this.state.id)[0],t=n.a.createElement("div",null,n.a.createElement(d.a,{id:"app.confirm",defaultMessage:"Confirm"},e=>n.a.createElement(p.Button,{label:e,icon:"pi pi-check",onClick:this.confirm,className:"confirm"})),n.a.createElement(d.a,{id:"app.cancel",defaultMessage:"Cancel"},e=>n.a.createElement(p.Button,{label:e,icon:"pi pi-times",onClick:this.onHide,className:"p-button-secondary confirm"})));return n.a.createElement(D.Dialog,{ref:"candidates-dialog",contentStyle:{maxHeight:"600px",width:"360px"},header:this.state.configurationHeader,visible:this.state.visible,footer:t,onHide:this.onHide,className:"modal-candidates"},n.a.createElement("div",{className:"p-grid"},n.a.createElement("div",{className:"p-col"},this.state.namesurnameLabel),n.a.createElement("div",{className:"p-col"},n.a.createElement(O.InputText,{ref:e=>{this.name=e},value:this.state.name,onChange:e=>{this.setState({name:e.target.value})}}))),n.a.createElement("div",{className:"p-grid"},n.a.createElement("div",{className:"p-col"},this.state.genderLabel),n.a.createElement("div",{className:"p-col"},k,n.a.createElement(Y.RadioButton,{value:k,name:"sex",onChange:e=>this.setState({sex:e.value}),checked:this.state.sex===k}),w,n.a.createElement(Y.RadioButton,{value:w,name:"sex",onChange:e=>this.setState({sex:e.value}),checked:this.state.sex===w}))),n.a.createElement("div",{className:"p-grid"},n.a.createElement("div",{className:"p-col"},n.a.createElement(d.a,{ref:"upload",id:"app.configuration.chooseimage",defaultMessage:"Choose Image"},t=>n.a.createElement(J,{ref:K,accept:"image/*",maxFileSize:6e4,onSelect:this.onSelect,chooseLabel:t,party:this,candidate:e,previewWidth:150})))),n.a.createElement("div",{className:"p-grid"},n.a.createElement("hr",{style:{width:"110%",background:"#fff"}}),n.a.createElement("div",{className:"p-col admin-candidates"},n.a.createElement(d.a,{id:"app.insert",defaultMessage:"Insert"},e=>n.a.createElement(p.Button,{label:e,icon:"pi pi-check",onClick:()=>{var e={name:this.state.name,sex:this.state.sex,image:this.state.image,label:this.state.name};if(G(e,this.state.candidates)){var t=this.state.generateId;t||(t=b()),this.setState({generateId:t+1}),e.id=t,e.value=t,this.state.candidates.push(e),this.refs.boxCandidates.forceUpdate()}},className:"confirm"})),n.a.createElement(d.a,{id:"app.update",defaultMessage:"Update"},e=>n.a.createElement(p.Button,{label:e,icon:"pi pi-check",onClick:()=>{var e={id:this.state.id,name:this.state.name,sex:this.state.sex,image:this.state.image,label:this.state.name};G(e,this.state.candidates)&&(this.state.candidates.forEach(e=>{e.value===this.state.id&&(e.label=this.state.name,e.id=this.state.id,e.name=this.state.name,e.image=this.state.image,e.sex=this.state.sex)}),this.refs.boxCandidates.forceUpdate())},className:"confirm"})),n.a.createElement(d.a,{id:"app.delete",defaultMessage:"Delete"},e=>n.a.createElement(p.Button,{label:e,icon:"pi pi-check",onClick:()=>{var e=this.state.candidates.map(e=>e.id).indexOf(this.state.id);this.state.candidates.splice(e,1),this.setState({id:"",name:"",image:"",sex:""}),this.refs.upload.refs.candidateUpload.state.files.pop(),this.refs["candidates-dialog"].forceUpdate()},className:"confirm"})))),n.a.createElement("div",{className:"p-grid"},n.a.createElement("div",{className:"p-col"},n.a.createElement(q.ListBox,{ref:"boxCandidates",value:this.state.id,filter:!0,options:this.state.candidates,onChange:e=>{var t=this.state.candidates.filter(t=>t.id===parseInt(e.value))[0];e.value?this.setState({id:e.value,name:t.name,sex:t.sex,image:t.image,opened:!0}):this.setState({id:"",name:"",sex:"",image:"",opened:!0})},itemTemplate:this.imgTemplate,style:{width:"30em"},listStyle:{maxHeight:"250px"}}))))}}class $ extends s.Component{constructor(e){super(e),this.state={}}render(){if("PREPARE"===Oe.state){var e={color:"#"+this.props.party.votingPaper.color},t="",a="",i="",s=u(this.props.party);if(s||!this.props.party.name){var r="";this.props.party.name||(r=" voting-paper-admin"),t=n.a.createElement(p.Button,{icon:"pi pi-plus",className:"admin-button"+r,style:e,onClick:e=>{e.stopPropagation(),this.refs.modalInsertParty.setState({partyName:"",partyTitle:"",image:"",operation:"insert",opened:!0}),this.refs.modalInsertParty.open()}})}return this.props.party.name&&(a=n.a.createElement(p.Button,{icon:"pi pi-briefcase",className:"admin-button",style:e,onClick:e=>{e.stopPropagation(),this.refs.modalParty.setState({partyName:this.props.party.name,partyTitle:this.props.party.subtitle,image:this.props.party.image,operation:"update",opened:!0}),this.refs.modalParty.open()}}),!s&&this.props.party.votingPaper.maxCandidates&&this.props.party.votingPaper.maxCandidates>0&&(i=n.a.createElement(p.Button,{icon:"pi pi-users",className:"admin-button",style:e,onClick:e=>{e.stopPropagation(),this.refs.modalCandidates.setState({operation:"update",opened:!0}),this.refs.modalCandidates.open()}}))),n.a.createElement("div",{className:"admin-buttons"},n.a.createElement(V,{ref:"modalParty",party:this.props.party,votingPaper:this.props.votingPaper}),n.a.createElement(V,{ref:"modalInsertParty",party:this.props.party,votingPaper:this.props.votingPaper}),n.a.createElement(X,{ref:"modalCandidates",partyComponent:this.props.partyComponent,party:this.props.party,votingPaper:this.props.votingPaper}),a,t,i)}return""}}var Q=a(75),Z=a.n(Q),ee=(a(136),"group"),te="party";class ae extends p.Button{putX(e){if((!this.refs["admin-buttons"].refs.modalParty&&!this.refs["admin-buttons"].refs.modalInsertParty&&!this.refs["admin-buttons"].refs.modalCandidates||!this.refs["admin-buttons"].refs.modalParty.state.visible&&!this.refs["admin-buttons"].refs.modalInsertParty.state.visible&&!this.refs["admin-buttons"].refs.modalCandidates.state.visible)&&(e.value=this.props.party,!e.target.classList.contains("excludeSelect")&&M(e))){e.value.selected?x(e.value,I):f(e.value,I);var t=this.props.party.name;this.props.party.subtitle&&(t=t+" "+this.props.party.subtitle),this.selectedItem?(this.selectedItem=null,e.value.selected=!1):(this.selectedItem=n.a.createElement("img",{className:"button-selected",alt:t,src:Z.a}),e.value.selected=!0),this.forceUpdate()}}renderIcon(){if(this.props.icon){var e=L()(this.props.icon,"p-c",{"p-button-icon-left":"right"!==this.props.iconPos,"p-button-icon-right":"right"===this.props.iconPos}),t=this.props.party.name;return this.props.party.subtitle&&(t=t+" "+this.props.party.subtitle),n.a.createElement("span",{className:e},this.props.party.image&&n.a.createElement("img",{alt:t,src:"data:image/jpeg;base64,".concat(this.props.party.image)}),this.selectedItem)}return this.selectedItem}renderLabel(){if(0===this.props.votingPaper.props.config.maxCandidates||this.props.party.name&&(!this.props.party.candidates||0===this.props.party.candidates.length)){var e=this.props.party.name||"p-btn",t="";return"undefined"!==this.props.party.subtitle&&(t=this.props.party.subtitle),n.a.createElement("span",{className:"p-button-text p-c"},e,n.a.createElement("span",{className:"p-button-subtext p-c"},t))}}renderCandidates(){if(this.props.party.candidates)return n.a.createElement(U,{config:this.props.party.candidates,maxcandidates:m(this.props.party).maxCandidates})}render(){this.props.party.type=u(this.props.party)?ee:te,this.props.party.votingPaper=m(this.props.party);var e=L()("p-button p-component",this.props.className,{"p-button-icon-only":this.props.icon&&!this.props.party.name&&!this.props.party.candidates,"p-button-text-icon-left":this.props.icon&&(this.props.party.name||this.props.party.candidates)&&"left"===this.props.iconPos,"p-button-text-icon-right":this.props.icon&&(this.props.party.name||this.props.party.candidates)&&"right"===this.props.iconPos,"p-button-text-only":!this.props.icon&&(this.props.party.name||this.props.party.candidates),"p-disabled":this.props.disabled}),t=this.renderIcon(),a=this.renderLabel(),i=this.renderCandidates(),s=Object.assign({},this.props);return delete s.iconPos,delete s.icon,delete s.tooltip,delete s.tooltipOptions,delete s.party,delete s.votingPaper,n.a.createElement("div",Object.assign({ref:e=>this.element=e},s,{className:e}),n.a.createElement($,{party:this.props.party,partyComponent:this,votingPaper:this.props.votingPaper,ref:"admin-buttons"}),"left"===this.props.iconPos&&t,a,i,"right"===this.props.iconPos&&t,this.props.children)}}a(137),a(138),a(139),a(140);class ie extends s.Component{constructor(e){super(e),this.jsonData=e}renderPartiesByGroup(e){return e.parties.map(t=>this.renderParty(e,t))}renderParties(e){if(e)return e.map(e=>this.renderParty({id:0},e))}renderParty(e,t){var a=Object.assign({});return a.key="party-"+e.id+"-"+t.id,a.icon="pi",a.className="p-button-secondary",a.party=t,a.ref=a.key,a.id=a.key,a.votingPaper=this,n.a.createElement(ae,Object.assign({},a,{onClick:e=>{this.refs[a.ref].putX(e)}}))}renderGroup(e){if(e.name){var t,a={gridRow:"1 / "+(e.parties.length+1)},i="";e.parties.length>1&&(i="is-grid"),e.image&&(t="pi");var s=Object.assign({});return s.key="group-"+e.id,s.icon=t,s.party=e,s.className="p-button-secondary first-row "+i,s.style=a,s.ref=s.key,s.id=s.key,s.votingPaper=this,n.a.createElement(ae,Object.assign({},s,{onClick:e=>{this.refs[s.ref].putX(e)}}))}}render(){return this.props.visible?this.jsonData.config.groups?n.a.createElement("div",{className:"page"},this.jsonData.config.groups.map((e,t)=>{var a,i;return a=this.renderPartiesByGroup(e),i=this.renderGroup(e),n.a.createElement("div",{key:"parties-"+t,className:"content-party resize-"+t%2},i,a)}),n.a.createElement($,{party:{votingPaper:this.props.config},votingPaper:this,ref:"vt-admin-buttons"})):n.a.createElement("div",{className:"page"},n.a.createElement("div",{key:"parties-0",className:"content-party resize-0"},this.renderParties(this.jsonData.config.parties)),n.a.createElement($,{party:{votingPaper:this.props.config},votingPaper:this,ref:"vt-admin-buttons"})):n.a.createElement("div",{className:"page"})}}a(141);var se=a(76),ne=a(41),re=a(77),oe=a.n(re),pe=a(78),le=a.n(pe),ce=new oe.a({clientId:"frontend",realm:"vota-domain",url:"http://vota-auth.vige.it:8480/auth"}),de=le.a.create({headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"}}),me=ce.login,he=ce.logout,ue=()=>ce.token,ge={initKeycloak:e=>{ce.init({onLoad:"check-sso",silentCheckSsoRedirectUri:window.location.origin+"/frontend/silent-check-sso.html",pkceMethod:"S256"}).then(t=>{t?(de.defaults.headers.common.Authorization="Bearer "+ue(),e()):(console.warn("not authenticated!"),me())})},doLogin:me,doLogout:he,getToken:ue,updateToken:e=>ce.updateToken(5).then(e).catch(me),getUsername:()=>ce.tokenParsed.preferred_username,axiosInstance:de};class fe extends s.Component{constructor(e){super(e),this.state={},this.state.confirmHeader=n.a.createElement(d.a,{id:"app.confirm.header",defaultMessage:"Confirm your vote"}),this.state.confirmBody=n.a.createElement(d.a,{id:"app.confirm.body",defaultMessage:"By clicking on (Yes) you will confirm the sending of the data. Once confirmed you will not be able to go back. Confirm the rescue?"}),this.open=this.open.bind(this),this.errors=this.errors.bind(this),this.confirm=this.confirm.bind(this),this.onHide=this.onHide.bind(this)}open(){this.setState({visible:!0})}errors(e){var t=n.a.createElement(d.a,{id:"app.error",defaultMessage:"Error"});this.props.window.refs.validator.growl.show({severity:"error",summary:t,detail:e.message})}createVote(){var e={votingPapers:[]};return Oe.votingPapers.forEach(t=>e.votingPapers.push({id:t.id})),I.forEach(t=>{for(var a=t.votingPaper,i={},s=0;s<e.votingPapers.length;s++)e.votingPapers[s].id===a.id&&(i=e.votingPapers[s]);i.id||0===i.id||(i.id=a.id,e.votingPapers.push(i)),t.type===ee?i.group={id:t.id}:t.type===te?i.party={id:t.id}:t.type===j&&(i.party.candidates||(i.party.candidates=[]),i.party.candidates.push({id:t.id}))}),e}confirm(){ge.updateToken().then(()=>{ge.axiosInstance.defaults.headers.common.Authorization="Bearer "+ge.getToken(),this.doConfirm()})}doConfirm(){var e=o.a.findDOMNode(this).querySelectorAll(".pi-check")[0];e.className="pi pi-spin pi-spinner p-c p-button-icon-left",ge.axiosInstance.post("http://vota-voting.vige.it:8080/vote",this.createVote()).then(t=>(e.className="pi pi-check p-c p-button-icon-left",this.setState({visible:!1}),this.props.window.setState({visible:!1}),t)).catch(t=>{e.className="pi pi-check p-c p-button-icon-left",this.errors(t),console.log(t)})}onHide(){this.setState({visible:!1})}componentDidUpdate(){var e=o.a.findDOMNode(this).getElementsByClassName("p-rowgroup-header");Oe.votingPapers.forEach(t=>{for(var a=0;a<e.length;a++)e[a]&&e[a].innerHTML.indexOf('id="'+t.id)>=0&&(e[a].style.setProperty("background-color","#"+t.color),e[a].style.setProperty("border-color","#"+t.color))})}headerTemplate(e){return n.a.createElement("span",{className:"voting-paper-field",id:e.votingPaper.id},e.votingPaper.name)}footerTemplate(e){return[n.a.createElement("td",{key:e.votingPaper.name+"_footerTotalLabel",colSpan:"2"})]}sortByElement(e,t,a="ascending"){var i=e.votingPaper.id-t.votingPaper.id+e.type.toLowerCase().localeCompare(t.type.toLowerCase());return"ascending"===a?i:-1*i}sort(e){return e.sort((e,t)=>this.sortByElement(e,t,"descending"))}render(){var e=n.a.createElement("div",null,n.a.createElement(d.a,{id:"app.yes",defaultMessage:"Yes"},e=>n.a.createElement(p.Button,{label:e,icon:"pi pi-check",onClick:this.confirm,className:"confirm"})),n.a.createElement(d.a,{id:"app.no",defaultMessage:"No"},e=>n.a.createElement(p.Button,{label:e,icon:"pi pi-times",onClick:this.onHide,className:"p-button-secondary confirm"})));return n.a.createElement(D.Dialog,{contentStyle:{maxHeight:"500px"},header:this.state.confirmHeader,visible:this.state.visible,footer:e,onHide:this.onHide},this.state.confirmBody,n.a.createElement("br",null),n.a.createElement("br",null),n.a.createElement(d.a,{id:"app.confirm.norecordsfound",defaultMessage:"Empty selection"},e=>n.a.createElement(se.DataTable,{value:this.sort(I),rowGroupMode:"subheader",sortField:"votingPaper",sortOrder:1,groupField:"votingPaper",rowGroupHeaderTemplate:this.headerTemplate,rowGroupFooterTemplate:this.footerTemplate,emptyMessage:e},n.a.createElement(ne.Column,{field:"type",body:e=>n.a.createElement("b",null,n.a.createElement(d.a,{id:"app.confirm."+e.type,defaultMessage:e.type}))}),n.a.createElement(ne.Column,{field:"name"}))))}}var ve=a(79),be=a.n(ve);class ye extends s.Component{constructor(e){super(e),this.state={},this.state.confirmHeader=n.a.createElement(d.a,{id:"app.confirm.ins.header",defaultMessage:"Confirm your update"}),this.state.confirmBody=n.a.createElement(d.a,{id:"app.confirm.ins.body",defaultMessage:"By clicking on (Yes) you will confirm the sending of the data. Confirm the rescue?"}),this.open=this.open.bind(this),this.errors=this.errors.bind(this),this.confirm=this.confirm.bind(this),this.onHide=this.onHide.bind(this)}open(){this.setState({visible:!0})}errors(e){this.props.window.refs.ruler.errors({message:e.message})}doConfirm(){var e=JSON.parse(be()(Oe)),t=o.a.findDOMNode(this).querySelectorAll(".pi-check")[0];t.className="pi pi-spin pi-spinner p-c p-button-icon-left",ge.axiosInstance.post("http://vota-votingpapers.vige.it:8180/votingPapers",e).then(e=>(t.className="pi pi-check p-c p-button-icon-left",this.setState({visible:!1}),e)).catch(e=>{this.errors(e),t.className="pi pi-check p-c p-button-icon-left",console.log(e)})}confirm(){ge.updateToken().then(()=>{ge.axiosInstance.defaults.headers.common.Authorization="Bearer "+ge.getToken(),this.doConfirm()})}onHide(){this.setState({visible:!1})}headerTemplate(e){return n.a.createElement("span",{className:"voting-paper-field",id:e.votingPaper.id},e.votingPaper.name)}footerTemplate(e){return[n.a.createElement("td",{key:e.votingPaper.name+"_footerTotalLabel",colSpan:"2"})]}render(){var e=n.a.createElement("div",null,n.a.createElement(d.a,{id:"app.yes",defaultMessage:"Yes"},e=>n.a.createElement(p.Button,{label:e,icon:"pi pi-check",onClick:this.confirm,className:"confirm"})),n.a.createElement(d.a,{id:"app.no",defaultMessage:"No"},e=>n.a.createElement(p.Button,{label:e,icon:"pi pi-times",onClick:this.onHide,className:"p-button-secondary confirm"})));return n.a.createElement(D.Dialog,{contentStyle:{maxHeight:"500px"},header:this.state.confirmHeader,visible:this.state.visible,footer:e,onHide:this.onHide},this.state.confirmBody,n.a.createElement("br",null),n.a.createElement("br",null))}}var Ee=a(80),Ce=a(81),xe=a(82),Pe=(a(189),[{label:"Bigger",value:"bigger"},{label:"Bigger party groups",value:"bigger-partygroup"},{label:"Little",value:"little"},{label:"Little no groups",value:"little-nogroup"}]);class Se extends s.Component{constructor(){super(),this.state={votingPaper:"",app:"",operation:"",disjointed:!1,maxCandidates:0,color:"",type:""},this.state.configurationHeader=n.a.createElement(d.a,{id:"app.configuration.header",defaultMessage:"Configure your Voting Paper"}),this.state.configurationInsertHeader=n.a.createElement(d.a,{id:"app.configuration.insert.header",defaultMessage:"Add your Voting Paper"}),this.state.name=n.a.createElement(d.a,{id:"app.configuration.name",defaultMessage:"Name"}),this.state.disjointedLabel=n.a.createElement(d.a,{id:"app.configuration.disjointed",defaultMessage:"Disjointed vote"}),this.state.maxCandidatesLabel=n.a.createElement(d.a,{id:"app.configuration.maxcandidates",defaultMessage:"Candidates number"}),this.state.templatesLabel=n.a.createElement(d.a,{id:"app.configuration.templateslabel",defaultMessage:"Template Type"}),this.state.colorLabel=n.a.createElement(d.a,{id:"app.configuration.color",defaultMessage:"Voting Paper color"}),this.open=this.open.bind(this),this.confirm=this.confirm.bind(this),this.delete=this.delete.bind(this),this.onHide=this.onHide.bind(this)}componentDidUpdate(){if("insert"!==this.state.operation||this.state.votingPaper.value||this.name.element.focus(),this.state.app&&this.state.operation.startsWith("confirmed")){var e=E(this.state.app);if(this.setState({operation:""}),"confirmed_insert"===this.state.operation)e[e.length-3].click();else if("confirmed_update"===this.state.operation&&this.state.app.state.activeItem.id===this.state.votingPaper.value.id){var t=0;e.forEach((e,a)=>{e.className.indexOf("-"+this.state.app.state.activeItem.id)>=0&&(t=a)}),e[t].click()}}}open(){this.setState({visible:!0})}confirm(){if(((e,t)=>{var a=e.votingPaper.value;return a&&a.label?!a||a.label.length>50?(z({name:"name",message:n.a.createElement(d.a,{id:"app.admin.error.maxname",defaultMessage:"You can specify a maximum length of {number} characters for the name",values:{number:50}})}),!1):!a||t.filter(e=>e.name.toUpperCase()===a.label.toUpperCase()&&e.id!==a.id).length>0?(z({name:"name",message:n.a.createElement(d.a,{id:"app.admin.error.existingname",defaultMessage:"The name of the voting paper already exists"})}),!1):!(!a||t.filter(t=>("little-nogroup"===e.type&&"little-nogroup"!==t.type||"little-nogroup"!==e.type&&"little-nogroup"===t.type)&&t.id===a.id).length>0)||(z({name:"name",message:n.a.createElement(d.a,{id:"app.admin.error.littlenogroup",defaultMessage:"You cannot pass from a party voting paper to a group voting paper. Remove and create again the voting paper"})}),!1):(z({name:"name",message:n.a.createElement(d.a,{id:"app.admin.error.name",defaultMessage:"The name of the voting paper is mandatory"})}),!1)})(this.state,Oe.votingPapers)){if("update"===this.state.operation)Oe.votingPapers.forEach(e=>{e.id===this.state.votingPaper.value.id&&(e.name=this.state.votingPaper.value.label,e.disjointed=this.state.disjointed,e.maxCandidates=this.state.maxCandidates,e.color=this.state.color,e.type=this.state.type)}),this.state.app.state.items.forEach(e=>{e.id===this.state.votingPaper.value.id&&(e.label=this.state.votingPaper.value.label)}),this.setState({visible:!1,operation:"confirmed_update"});else{var e,t,a=b();"little-nogroup"===this.state.type?t=[]:e=[],Oe.votingPapers.push({id:a,name:this.state.votingPaper.value.label,groups:e,parties:t,disjointed:this.state.disjointed,maxCandidates:this.state.maxCandidates,color:this.state.color,type:this.state.type});var i=this.state.app.state.items.length-2;this.state.app.setState({items:v({id:a,label:this.state.votingPaper.value.label,icon:"pi pi-fw pi-briefcase"},i,this.state.app.state.items)}),this.setState({visible:!1,operation:"confirmed_insert"})}this.state.app.forceUpdate()}}delete(){C(this.state.votingPaper.value,this.state.app),this.setState({visible:!1,operation:"confirmed_delete"})}onHide(){this.setState({visible:!1})}imgTemplate(e){var t="./template_images/"+e.value+".png";return n.a.createElement("div",{className:"p-clearfix"},n.a.createElement("img",{alt:e.label,src:t,style:{display:"inline-block",margin:"5px 0 0 5px",width:48}}),n.a.createElement("span",{style:{fontSize:"1em",float:"right",margin:"1em .5em 0 0"}},e.label))}render(){var e=this.state.votingPaper.value,t="";e&&"update"===this.state.operation&&(t=n.a.createElement(d.a,{id:"app.delete",defaultMessage:"Delete"},e=>n.a.createElement(p.Button,{label:e,icon:"pi pi-check",onClick:this.delete,className:"confirm"})));var a=n.a.createElement("div",null,n.a.createElement(d.a,{id:"app.confirm",defaultMessage:"Confirm"},e=>n.a.createElement(p.Button,{label:e,icon:"pi pi-check",onClick:this.confirm,className:"confirm"})),t,n.a.createElement(d.a,{id:"app.cancel",defaultMessage:"Cancel"},e=>n.a.createElement(p.Button,{label:e,icon:"pi pi-times",onClick:this.onHide,className:"p-button-secondary confirm"}))),i=this.state.configurationInsertHeader;return"update"===this.state.operation&&(i=this.state.configurationHeader),n.a.createElement(D.Dialog,{contentStyle:{maxHeight:"600px",width:"360px"},header:i,visible:this.state.visible,footer:a,onHide:this.onHide,className:"modal-voting-paper"},n.a.createElement("div",{className:"p-grid"},n.a.createElement("div",{className:"p-col"},this.state.name),n.a.createElement("div",{className:"p-col"},n.a.createElement(O.InputText,{ref:e=>{this.name=e},value:e?e.label:"",onChange:t=>this.setState({votingPaper:{value:{label:t.target.value,id:e?e.id:"",icon:"pi pi-fw pi-briefcase"}}}),onKeyPress:e=>{13===e.nativeEvent.keyCode&&this.confirm()}}))),n.a.createElement("div",{className:"p-grid"},n.a.createElement("div",{className:"p-col"},this.state.disjointedLabel),n.a.createElement("div",{className:"p-col"},n.a.createElement(Ee.Checkbox,{onChange:t=>{var a;(a=e)&&I.filter(e=>e.votingPaper.id===a.id).length>0&&(z({name:"name",message:n.a.createElement(d.a,{id:"app.admin.error.disjointed",defaultMessage:"You must deselect all votes of the voting paper before to change the disjointed vote '{name}'",values:{name:a.label}})}),1)||this.setState({disjointed:t.checked})},checked:this.state.disjointed}))),n.a.createElement("div",{className:"p-grid"},n.a.createElement("div",{className:"p-col"},this.state.maxCandidatesLabel),n.a.createElement("div",{className:"p-col"},n.a.createElement(Ce.Spinner,{onChange:e=>this.setState({maxCandidates:Number.isInteger(e.value)?parseInt(e.value):0}),value:this.state.maxCandidates,min:0,max:3}))),n.a.createElement("div",{className:"p-grid"},n.a.createElement("div",{className:"p-col"},this.state.colorLabel),n.a.createElement("div",{className:"p-col"},n.a.createElement(xe.ColorPicker,{value:this.state.color,onChange:e=>this.setState({color:e.value})}))),n.a.createElement("div",{className:"p-grid"},n.a.createElement("div",{className:"p-col"},this.state.templatesLabel)),n.a.createElement("div",{className:"p-grid"},n.a.createElement("div",{className:"p-col"},n.a.createElement(q.ListBox,{value:this.state.type,filter:!0,options:Pe,onChange:e=>{e.value&&this.setState({type:e.value})},itemTemplate:this.imgTemplate,style:{width:"105em"},listStyle:{maxHeight:"250px"}}))))}}var Ne=a(83),ke=(a(191),a(84)),we=a.n(ke),Me=a(85),_e=a.n(Me),Ie=a(86),Te=a(87),He=a.n(Te),je=a(88),Ue=a.n(je),Be=a(42),Le=a.n(Be);class De extends n.a.Component{constructor(e){super(e),this._initStompClient=()=>{this.client=Ue.a.over(new He.a(this.props.url,null,this.props.options)),this.client.heartbeat.outgoing=this.props.heartbeat,this.client.heartbeat.incoming=this.props.heartbeat,Object.keys(this.props).includes("heartbeatIncoming")&&(this.client.heartbeat.incoming=this.props.heartbeatIncoming),Object.keys(this.props).includes("heartbeatOutgoing")&&(this.client.heartbeat.outgoing=this.props.heartbeatOutgoing),this.props.debug||(this.client.debug=()=>{})},this._cleanUp=()=>{this.setState({connected:!1}),this.retryCount=0,this.subscriptions.clear()},this._log=e=>{this.props.debug&&console.log(e)},this._subscribe=e=>{if(!this.subscriptions.has(e)){var t=this.client.subscribe(e,e=>{this.props.onMessage(this._processMessage(e.body),e.headers.destination)},this.props.subscribeHeaders);this.subscriptions.set(e,t)}},this._processMessage=e=>{try{return JSON.parse(e)}catch(t){return e}},this._unsubscribe=e=>{this.subscriptions.get(e).unsubscribe(),this.subscriptions.delete(e)},this._connect=()=>{this._initStompClient(),this.client.connect(this.props.headers,()=>{this.setState({connected:!0}),this.props.topics.forEach(e=>{this._subscribe(e)}),this.props.onConnect()},e=>{e&&(Object.keys(this.props).includes("onConnectFailure")?this.props.onConnectFailure(e):this._log(e.stack)),this.state.connected&&(this._cleanUp(),this.props.onDisconnect()),this.props.autoReconnect&&!this.state.explicitDisconnect&&(this._timeoutId=setTimeout(this._connect,this.props.getRetryInterval(this.retryCount++)))})},this.connect=()=>{this.setState({explicitDisconnect:!1}),this.state.connected||this._connect()},this.disconnect=()=>{this._timeoutId&&(clearTimeout(this._timeoutId),this._timeoutId=null),this.setState({explicitDisconnect:!0}),this.state.connected&&(this.subscriptions.forEach(e=>{this._unsubscribe(e)}),this.client.disconnect(()=>{this._cleanUp(),this.props.onDisconnect(),this._log("Stomp client is successfully disconnected!")}))},this.sendMessage=(e,t,a={})=>{if(!this.state.connected)throw new Error("Send error: SockJsClient is disconnected");this.client.send(e,a,t)},this.state={connected:!1,explicitDisconnect:!1},this.subscriptions=new Map,this.retryCount=0}componentDidMount(){this._connect()}componentWillUnmount(){this.disconnect()}shouldComponentUpdate(){return!1}UNSAFE_componentWillReceiveProps(e){this.state.connected&&(Le.a.difference(e.topics,this.props.topics).forEach(e=>{this._log("Subscribing to topic: "+e),this._subscribe(e)}),Le.a.difference(this.props.topics,e.topics).forEach(e=>{this._log("Unsubscribing from topic: "+e),this._unsubscribe(e)}))}render(){return null}}De.defaultProps={onConnect:()=>{},onDisconnect:()=>{},getRetryInterval:e=>1e3*e,options:{},headers:{},subscribeHeaders:{},autoReconnect:!0,debug:!1,heartbeat:1e4};var Oe,Ae,Re=De,ze=a(89);class Fe extends s.Component{constructor(){super(),this.state={items:[],visible:!0},Ae=this,ge.axiosInstance.get("http://vota-votingpapers.vige.it:8180/votingPapers").then((function(e){var t={};(Oe=e.data).votingPapers&&Oe.votingPapers[0]&&(t={id:Oe.votingPapers[0].id,label:Oe.votingPapers[0].name}),Ae.setState({activeItem:t}),Oe.votingPapers.map(e=>"PREPARE"===Oe.state?Ae.state.items.push({id:e.id,label:e.name,icon:"pi pi-fw pi-briefcase"}):Ae.state.items.push({id:e.id,label:e.name})),Ae.setState({confirmButtonLabel:n.a.createElement(d.a,{id:"app.confirm",defaultMessage:"Confirm"})}),"PREPARE"===Oe.state&&Ae.state.items.push({label:"+"}),(Oe.votingPapers.length>0||"PREPARE"===Oe.state)&&Ae.state.items.push({label:Ae.state.confirmButtonLabel});var a=E(Ae);a&&a[0]&&a[0].click()})).catch((function(e){console.log(e)}))}componentDidUpdate(){"websocket"===this.state.operation&&(E(this),this.setState({operation:void 0}))}render(){var e=n.a.createElement(fe,{ref:"confirm",window:this}),t="",a="",i=n.a.createElement(Re,{url:"http://vota-votingpapers.vige.it:8180/votingpaper-websocket",topics:["/topic/votingpaper"],onMessage:e=>{e.votingPapers.forEach((e,t)=>{var a=this.state.items[t];if(0===this.state.items.filter(t=>t.id===e.id).length){Oe.votingPapers.push(e);var i=this.state.items.length-2;this.setState({items:v({id:e.id,label:e.name,icon:"pi pi-fw pi-briefcase"},i,this.state.items)})}else if(a.id===e.id){a&&(a.label=e.name);var s=Oe.votingPapers[t];s&&(s.type=e.type,s.disjointed=e.disjointed,s.color=e.color,s.maxCandidates=e.maxCandidates,s.name=e.name,s.groups=e.groups,s.parties=e.parties)}}),Oe.votingPapers.filter(t=>-1===e.votingPapers.map(e=>e.id).indexOf(t.id)).forEach(e=>C(e,this));var t=y(this),a=this.state.items.map(e=>e.id).indexOf(this.state.activeItem.id);a>=0&&t[a].click(),Oe.state=e.state,this.setState({operation:"websocket"})}});return Oe&&"PREPARE"===Oe.state&&(e=n.a.createElement(ye,{ref:"confirm",window:this}),t=n.a.createElement(Se,{ref:"modalVotingPaper"}),a=n.a.createElement(W,{ref:"ruler"})),Oe?n.a.createElement("div",{className:"App"},i,n.a.createElement("div",{className:"content-section implementation"},n.a.createElement(T,{ref:"validator"}),a,n.a.createElement(Ne.TabMenu,{ref:"tabMenu",className:this.state.visible?"":"disabled",model:this.state.items,activeItem:this.state.activeItem,onTabChange:e=>{if("PREPARE"===Oe.state&&e.originalEvent.target.className.startsWith("pi")){var t=(e=>{if(e){var t="";return Oe.votingPapers.forEach(a=>{a.id===e.id&&(t=a)}),t}return""})(e.value);this.refs.modalVotingPaper.setState({votingPaper:e,app:this,operation:"update",disjointed:t.disjointed,maxCandidates:t.maxCandidates,color:t.color,type:t.type}),this.refs.modalVotingPaper.open()}else this.state.visible&&(e.value.label===this.state.confirmButtonLabel?this.refs.confirm.open():"+"===e.value.label?(this.refs.modalVotingPaper.setState({votingPaper:"",app:this,operation:"insert",disjointed:!1,maxCandidates:0,color:"1976D2",type:"bigger"}),this.refs.modalVotingPaper.open()):this.setState({activeItem:e.value}))}}),t,e,n.a.createElement("p",{className:"powered"},n.a.createElement("img",{alt:"logo",className:"logo",src:_e.a}),n.a.createElement(d.a,{id:"app.powered",defaultMessage:"Powered by "}),n.a.createElement("a",{href:"http://www.vige.it"},"Vige"))),Oe&&Oe.votingPapers.map(e=>{var t=n.a.createElement(d.a,{id:"app.confirm.confirmedheader",defaultMessage:"Your vote was sent!"}),a=n.a.createElement(d.a,{id:"app.confirm.confirmedbody",defaultMessage:"Your vote has been sent successfully. The results will be shown shortly. We thank you for your participation"});return n.a.createElement("header",{key:"header-"+e.id,className:"App-header "+e.type,ref:"header-"+e.id,style:e.name!==this.state.activeItem.label?{display:"none"}:{backgroundImage:"url(".concat(we.a,")"),backgroundColor:"#"+e.color,borderColor:"#"+e.color}},n.a.createElement(ie,{config:e,visible:this.state.visible,ref:"votingpaper-"+e.id}),n.a.createElement(Ie.Panel,{header:t,style:this.state.visible?{display:"none"}:{}},a))})):n.a.createElement(ze.ProgressSpinner,null)}}var Ge=Fe,We=(a(226),a(227),a(228),a(229),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)));function Ve(e,t){navigator.serviceWorker.register(e).then(e=>{e.onupdatefound=()=>{var a=e.installing;null!=a&&(a.onstatechange=()=>{"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See http://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(e=>{console.error("Error during service worker registration:",e)})}var Ye=a(90),qe=a.n(Ye),Je=a(91),Ke=a.n(Je),Xe=a(92);Object(d.c)([...qe.a,...Ke.a]);var $e={it:Xe},Qe=navigator.language.split(/[-_]/)[0];ge.initKeycloak(()=>o.a.render(n.a.createElement(d.b,{locale:Qe,messages:$e[Qe]},n.a.createElement(Ge,null)),document.getElementById("root"))),function(e){if("serviceWorker"in navigator){if(new URL("/frontend",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",()=>{var t="".concat("/frontend","/service-worker.js");We?(!function(e,t){fetch(e).then(a=>{var i=a.headers.get("content-type");404===a.status||null!=i&&-1===i.indexOf("javascript")?navigator.serviceWorker.ready.then(e=>{e.unregister().then(()=>{window.location.reload()})}):Ve(e,t)}).catch(()=>{console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(()=>{console.log("This web app is being served cache-first by a service worker. To learn more, visit http://bit.ly/CRA-PWA")})):Ve(t,e)})}}()},73:function(e,t){},75:function(e,t,a){e.exports=a.p+"static/media/x.5067911c.png"},84:function(e,t,a){e.exports=a.p+"static/media/background.75de7822.png"},85:function(e,t,a){e.exports=a.p+"static/media/logo.71fca57e.ico"},92:function(e){e.exports=JSON.parse('{"app.powered":"Sviluppato da ","app.confirm":"Conferma","app.cancel":"Annulla","app.delete":"Rimuovi","app.insert":"Inserisci","app.update":"Aggiorna","app.confirm.header":"Conferma il voto","app.confirm.body":"Cliccando su \'Si\' confermerai l\'invio dei dati. Una volta confermato non potrai pi\xf9 tornare indietro. Confermi il salvataggio?","app.confirm.ins.header":"Conferma l\'aggiornamento","app.confirm.ins.body":"Cliccando su \'Si\' confermerai l\'invio dei dati. Confermi il salvataggio?","app.confirm.party":"partito","app.confirm.group":"coalizione","app.confirm.candidate":"candidato","app.confirm.norecordsfound":"Scheda bianca","app.confirm.confirmedheader":"Il tuo voto \xe8 stato confermato!","app.confirm.confirmedbody":"Il tuo voto \xe8 stato inviato con successo. A breve verranno mostrati i risultati. Ti ringraziamo per la tua partecipazione","app.configuration.header":"Configura la scheda","app.configuration.headerparty":"Configura il partito","app.configuration.headergroup":"Configura la coalizione","app.configuration.headercandidates":"Gestione dei candidati","app.configuration.headerinsertparty":"Inserisci il partito","app.configuration.headerinsertgroup":"Inserisci la coalizione","app.configuration.name":"Nome","app.configuration.namesurname":"Nome e cognome","app.configuration.gender":"Sesso","app.configuration.title":"Titolo","app.configuration.chooseimage":"Scegli l\'Immagine","app.configuration.disjointed":"Voto disgiunto","app.configuration.maxcandidates":"Numero di candidati","app.configuration.color":"Colore della scheda","app.configuration.templateslabel":"Tipo di scheda","app.configuration.insert.header":"Aggiungi la scheda","app.yes":"Si","app.no":"No","app.error":"Errore","app.error.candidate":"la candidatura di","app.error.party":"il partito","app.error.group":"la coalizione","app.error.message":"Non \xe8 possibile selezionare {type} {value}","app.admin.error.name":"Il nome della scheda \xe8 obbligatorio","app.admin.error.maxname":"Puoi specificare un numero massimo di {number} caratteri per il nome","app.admin.error.existingname":"Il nome della scheda esiste gi\xe0","app.admin.error.party.name":"Il nome del partito \xe8 obbligatorio","app.admin.error.group.name":"Il nome della coalizione \xe8 obbligatorio","app.admin.error.candidate.name":"Il nome del candidato \xe8 obbligatorio","app.admin.error.candidate.sex":"Il sesso del candidato \xe8 obbligatorio","app.admin.error.candidate.existingname":"Il nome del candidato esiste gi\xe0","app.admin.error.candidate.existingimage":"L\'immagine del candidato esiste gi\xe0","app.admin.error.candidate.casename":"Il nome e cognome del candidato devono iniziare con la lettera maiuscola e terminare con le lettere minuscole","app.admin.error.candidate.surname":"Inserire sia nome che cognome","app.admin.error.style":"Lo stile della scheda \xe8 obbligatorio","app.admin.error.disjointed":"Prima di modificare il voto disgiunto devi rimuovere tutte le selezioni effettuate sulla scheda \'{name}\'","app.admin.error.file.summary":"{0}: Dimensione non valida, ","app.admin.error.file.detail":"la dimensione massima \xe8 {0}.","app.admin.error.littlenogroup":"Non \xe8 possibile passare da un tipo di scheda a partito ad un tipo a coalizione o viceversa. Rimuovere e ricreare la scheda"}')},94:function(e,t,a){e.exports=a(230)},99:function(e,t,a){}},[[94,1,2]]]);
//# sourceMappingURL=main.8d82ab19.chunk.js.map