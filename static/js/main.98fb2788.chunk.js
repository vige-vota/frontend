(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{101:function(e,t,a){e.exports=a.p+"static/media/x.5067911c.png"},107:function(e,t,a){e.exports=a.p+"static/media/background.75de7822.png"},112:function(e){e.exports={"app.confirm":"Conferma","app.cancel":"Annulla","app.delete":"Rimuovi","app.insert":"Inserisci","app.update":"Aggiorna","app.confirm.header":"Conferma il voto","app.confirm.body":"Cliccando su 'Si' confermerai l'invio dei dati. Una volta confermato non potrai pi\xf9 tornare indietro. Confermi il salvataggio?","app.confirm.ins.header":"Conferma l'aggiornamento","app.confirm.ins.body":"Cliccando su 'Si' confermerai l'invio dei dati. Confermi il salvataggio?","app.confirm.party":"partito","app.confirm.group":"coalizione","app.confirm.candidate":"candidato","app.confirm.norecordsfound":"Scheda bianca","app.confirm.confirmedheader":"Il tuo voto \xe8 stato confermato!","app.confirm.confirmedbody":"Il tuo voto \xe8 stato inviato con successo. A breve verranno mostrati i risultati. Ti ringraziamo per la tua partecipazione","app.configuration.header":"Configura la scheda","app.configuration.headerparty":"Configura il partito","app.configuration.headergroup":"Configura la coalizione","app.configuration.referendum.headerparty":"Configura il voto","app.configuration.referendum.headergroup":"Configura il referendum","app.configuration.referendum":"REFERENDUM POPOLARE","app.configuration.headercandidates":"Gestione dei candidati","app.configuration.headerinsertparty":"Inserisci il partito","app.configuration.headerinsertgroup":"Inserisci la coalizione","app.configuration.referendum.headerinsertparty":"Inserisci il voto","app.configuration.referendum.headerinsertgroup":"Inserisci il referendum","app.configuration.name":"Nome","app.configuration.namesurname":"Nome e cognome","app.configuration.gender":"Sesso","app.configuration.title":"Titolo","app.configuration.chooseimage":"Scegli l'Immagine","app.configuration.newdate":"Nuova data","app.configuration.datedetails":"Inserisci la data","app.configuration.startingdate":"Data d'inizio","app.configuration.endingdate":"Data di fine","app.configuration.disjointed":"Voto disgiunto","app.configuration.maxcandidates":"Numero di candidati","app.admin.error.maxsubgroups":"Puoi specificare un numero massimo di {number} risposte per il referendum","app.configuration.zone":"Zona","app.configuration.choose.zone":"Scegli la zona","app.configuration.color":"Colore della scheda","app.configuration.templateslabel":"Tipo di scheda","app.configuration.insert.header":"Aggiungi la scheda","app.yes":"Si","app.no":"No","app.error":"Errore","app.error.candidate":"la candidatura di","app.error.party":"il partito","app.error.group":"la coalizione","app.error.referendum.vote":"il voto","app.error.message":"Non \xe8 possibile selezionare {type} {value}","app.admin.error.name":"Il nome della scheda \xe8 obbligatorio","app.admin.error.zone":"La zona \xe8 obbligatoria","app.admin.error.maxname":"Puoi specificare un numero massimo di {number} caratteri per il nome","app.admin.error.existingname":"Il nome della scheda esiste gi\xe0","app.admin.error.party.name":"Il nome del partito \xe8 obbligatorio","app.admin.error.group.name":"Il nome della coalizione \xe8 obbligatorio","app.admin.error.candidate.name":"Il nome del candidato \xe8 obbligatorio","app.admin.error.candidate.sex":"Il sesso del candidato \xe8 obbligatorio","app.admin.error.candidate.existingname":"Il nome del candidato esiste gi\xe0","app.admin.error.candidate.existingimage":"L'immagine del candidato esiste gi\xe0","app.admin.error.candidate.casename":"Il nome e cognome del candidato devono iniziare con la lettera maiuscola e terminare con le lettere minuscole","app.admin.error.candidate.surname":"Inserire sia nome che cognome","app.admin.error.style":"Lo stile della scheda \xe8 obbligatorio","app.admin.error.disjointed":"Prima di modificare il voto disgiunto devi rimuovere tutte le selezioni effettuate sulla scheda '{name}'","app.admin.error.dateempty":"Le date non devono essere vuote","app.admin.error.endingdate.current":"La data fine deve essere maggiore della data corrente","app.admin.error.endingdate.starting":"La data fine deve essere maggiore della data di inizio","app.admin.error.file.detail":"La dimensione massima \xe8 {0}.","app.admin.error.littlenogroup":"Non \xe8 possibile passare da un tipo di scheda a partito ad un tipo a coalizione o viceversa. Rimuovere e ricreare la scheda","app.admin.error.zonebigger":"La scheda deve avere la zona","app.admin.nodatesfound":"Non ci sono date","app.admin.dates.months.january":"Gennaio","app.admin.dates.months.february":"Febbraio","app.admin.dates.months.march":"Marzo","app.admin.dates.months.april":"Aprile","app.admin.dates.months.may":"Maggio","app.admin.dates.months.june":"Giugno","app.admin.dates.months.july":"Luglio","app.admin.dates.months.august":"Agosto","app.admin.dates.months.september":"Settembre","app.admin.dates.months.october":"Ottobre","app.admin.dates.months.november":"Novembre","app.admin.dates.months.december":"Dicembre","app.admin.dates.weeks.sunday":"Do","app.admin.dates.weeks.monday":"Lu","app.admin.dates.weeks.tuesday":"Ma","app.admin.dates.weeks.wednesday":"Me","app.admin.dates.weeks.thursday":"Gi","app.admin.dates.weeks.friday":"Ve","app.admin.dates.weeks.saturday":"Sa"}},118:function(e,t,a){e.exports=a(223)},125:function(e,t,a){},153:function(e,t,a){},155:function(e,t,a){},158:function(e,t,a){},160:function(e,t,a){},162:function(e,t,a){},170:function(e,t,a){},172:function(e,t,a){},174:function(e,t,a){},176:function(e,t,a){},178:function(e,t,a){},213:function(e,t,a){},215:function(e,t,a){},217:function(e,t,a){},219:function(e,t,a){},221:function(e,t,a){},223:function(e,t,a){"use strict";a.r(t);var n,i,r,s,o,c,l,p=a(0),d=a.n(p),u=a(97),m=(a(125),a(9)),f=a(10),g=a(12),h=a(11),v=a(13),b=a(5),y=a(228),E=a(6),k=a(98),j=a(50),O=a(26),C=a.n(O),P=a(99),N=a(51),w=a.n(N),x=new P.a({clientId:"frontend",realm:"vota-domain",url:"https://vota-auth.vige.it:8843"}),S=w.a.create({headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"}}),M=x.login,D=x.logout,I=function(){return x.token},T={initKeycloak:function(e){x.init({onLoad:"check-sso",silentCheckSsoRedirectUri:window.location.origin+"/silent-check-sso.html",pkceMethod:"S256"}).then(function(t){t?(S.defaults.headers.common.Authorization="Bearer "+I(),e()):(console.warn("not authenticated!"),M())})},doLogin:M,doLogout:D,getToken:I,updateToken:function(e){return x.updateToken(5).then(e).catch(M)},getUsername:function(){return x.tokenParsed.preferred_username},axiosInstance:S,getProfile:function(){return x.loadUserProfile()},getRoles:function(){return x.realmAccess.roles}},_=function(e,t){for(;null!==e;){if(e.id===t)return!0;e=q(e)}return!1},R=function e(t){var a=q(t);return null!=a?e(a):t},z=function(e){var t="";return e&&ut.votingPapers.forEach(function(a){t=L(e,a)}),t},L=function(e,t){var a="";return e&&(t.id===e&&(a=t),t.groups&&t.groups.forEach(function(t){t.id===e&&(a=t),t.parties&&t.parties.forEach(function(t){t.id===e&&(a=t),t.candidates&&t.candidates.forEach(function(t){t.id===e&&(a=t)})})})),a},H=function(e){var t=q(e);return null!=t&&t.parties},U=function(e){var t=q(e);return null!=t&&t.groups},A=function(e){var t=q(e);return null!=t&&t.candidates},F=function e(t,a){0===a.filter(function(e){return e===t}).length&&a.push(t);var n=q(t);!n.votingPaper||U(n)&&n.votingPaper.disjointed||n.votingPaper.type===Se||e(n,a)},B=function(e,t,a){var n=a.slice(0,t),i=a.slice(t);return n.concat(e,i)},W=function(){var e=-ut.nextId;return ut.nextId++,e},G=function(e){return C.a.findDOMNode(e).querySelectorAll(".p-menuitem-link")},Y=function(e){var t={};ut.votingPapers&&ut.votingPapers[0]&&(t={id:ut.votingPapers[0].id,label:ut.votingPapers[0].name}),e.setState({activeItem:t}),ut.votingPapers.map(function(t){return"PREPARE"!==ut.state||!T.getRoles().includes("admin")&&parseInt(ut.profile.attributes.block[0],10)!==t.id?e.state.items.push({id:t.id,label:t.name}):e.state.items.push({id:t.id,label:t.name,icon:"pi pi-fw pi-briefcase"})});var a=d.a.createElement(y.a,{id:"app.confirm",defaultMessage:"Confirm"});e.setState({confirmButtonLabel:a}),"PREPARE"===ut.state&&T.getRoles().includes("admin")&&e.state.items.push({label:"+"}),(ut.votingPapers.length>0||"PREPARE"===ut.state)&&e.state.items.push({label:a}),e.setState({operation:"created-tabs"})},V=function(e){var t=G(e);return ut&&ut.votingPapers.forEach(function(e,a){t[a].className.includes(e.type)||(t[a].className=t[a].className+" App-"+e.id+" "+e.type),t[a].style.setProperty("background-color","#"+e.color),t[a].style.setProperty("border-color","#"+e.color)}),t},J=function(e,t){var a=t.state.items.map(function(e){return e.id}).indexOf(e.id);if(t.state.activeItem.id===e.id){var n=G(t);0!==a?n[0].click():n[1].click()}t.state.items.splice(a,1),ut.votingPapers.splice(a,1),t.forceUpdate()},K=function e(t,a){if(0===a.filter(function(e){return q(e)===t}).length||U(t)&&t.votingPaper.disjointed){var n=a.indexOf(t);a.splice(n,1);var i=q(t);!i.votingPaper||U(i)&&i.votingPaper.disjointed||i.selected||A(t)&&0!==a.filter(function(e){return A(e)&&q(e)===i}).length||e(i,a)}},q=function(e){var t=null;return ut.votingPapers.forEach(function(a){a!==e&&(a.groups?a.groups.forEach(function(n){n===e?t=a:n.parties&&n.parties.forEach(function(a){a===e?t=n:a.candidates&&a.candidates.forEach(function(n){n===e&&(t=a)})})}):a.parties&&a.parties.forEach(function(n){n===e?t=a:n.candidates&&n.candidates.forEach(function(a){a===e&&(t=n)})}))}),t},X=function(e,t){var a=new FileReader;a.onload=function(){t.setState({image:a.result.replace(/^data:.+;base64,/,"")}),t.forceUpdate()};var n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="blob",n.onload=function(){200===this.status&&a.readAsDataURL(this.response)},n.send()},Z=function(e){for(var t=atob(e.image),a=new Array(t.length),n=0;n<t.length;n++)a[n]=t.charCodeAt(n);var i=new Uint8Array(a),r=new Blob([i],{type:"image/jpeg"});return new File([r],e.name,{type:"image/jpeg"})},Q=function(e){for(var t=e[0].size.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".");t.includes(".")&&t.endsWith("0");)t=t.slice(0,-1);return t+" KB"},$="M",ee="F",te=function(e){var t=e.value.votingPaper,a=ne.filter(function(e){return e.votingPaper===t});if(e.value.type===we){var i=a.filter(function(e){return e.type===we});return!!(e.value.selected||i.length<1||1===i.filter(function(t){return t===e.value}).length)||(n({name:e.value.name,type:d.a.createElement(y.a,{id:"app.error.group",defaultMessage:"the "+we})}),!1)}if(e.value.type===xe){var r=q(e.value),s=a.filter(function(e){return q(e)===r&&e.type===xe}),o=a.map(function(e){return e.type===xe?q(e):null}).filter(function(e,t,a){return a.indexOf(e)===t&&e}),c=a.filter(function(t){return t.type===re&&q(t)===e.value}).length>0;return!!(e.value.selected||c||s.length<1&&(e.value.votingPaper.type===Se||o.length<1)&&(e.value.votingPaper.type===Se||t.disjointed||a.filter(function(e){return e===r}).length>0||0===a.length))||(e.value.votingPaper.type===Se?n({name:e.value.name,type:d.a.createElement(y.a,{id:"app.error.referendum.vote",defaultMessage:"the vote"})}):n({name:e.value.name,type:d.a.createElement(y.a,{id:"app.error.party",defaultMessage:"the "+xe})}),!1)}var l=q(e.value),p=a.filter(function(e){return e.type===re}).filter(function(e){return q(e)===l}),u=a.filter(function(e){return e.type===xe}),m=u.filter(function(t){return t===q(e.value)}),f=u.filter(function(t){return t!==q(e.value)}),g=a.filter(function(e){return e===l||e===q(l)});return!(!(!t.disjointed&&(g.length>0||0===a.length)||t.disjointed&&(1===m.length||0===f.length))||!ae(p,e.value))||(n({name:e.value.name,type:d.a.createElement(y.a,{id:"app.error.candidate",defaultMessage:"the "+re})}),!1)},ae=function(e,t){var a=0,n=0,i=e.filter(function(e){return e!==t}),r=i.length;return t.selected||(t.sex===$&&a++,t.sex===ee&&n++,r++),i.forEach(function(e){e.sex===$&&a++,e.sex===ee&&n++}),Math.round(r/2)>=a&&Math.round(r/2)>=n},ne=[],ie=function(e){function t(){var e;return Object(m.a)(this,t),e=Object(g.a)(this,Object(h.a)(t).call(this)),n=e.errors.bind(Object(b.a)(Object(b.a)(e))),e}return Object(v.a)(t,e),Object(f.a)(t,[{key:"errors",value:function(e){var t={severity:"error",summary:d.a.createElement(y.a,{id:"app.error",defaultMessage:"Error"}),detail:d.a.createElement(y.a,{id:"app.error.message",defaultMessage:"Unable to select {type} {value}",values:{type:e.type,value:e.name}})};this.growl.show(t)}},{key:"render",value:function(){var e=this;return d.a.createElement(j.a,{ref:function(t){return e.growl=t}})}}]),t}(p.Component),re=(a(153),"candidate"),se=function(e){function t(){var e;return Object(m.a)(this,t),(e=Object(g.a)(this,Object(h.a)(t).call(this))).state={filteredCandidates:null},e.filterCandidates=e.filterCandidates.bind(Object(b.a)(Object(b.a)(e))),e.chosenCandidates=[],e}return Object(v.a)(t,e),Object(f.a)(t,[{key:"filterCandidates",value:function(e){var t=this;setTimeout(function(){var a;a=0===e.query.length?t.props.config.filter(function(e){return!t.chosenCandidates.find(function(t){return t===e.name})}):t.props.config.filter(function(a){return!t.chosenCandidates.find(function(e){return e===a.name})&&a.name.toLowerCase().startsWith(e.query.toLowerCase())}),t.setState({filteredCandidates:a})},250)}},{key:"itemTemplate",value:function(e){var t;return e.type=re,e.votingPaper=R(e),e.image&&(t=d.a.createElement("img",{className:"excludeSelect",alt:e.name,src:"data:image/jpeg;base64,".concat(e.image),style:{width:"32px",display:"inline-block",margin:"5px 0 2px 5px"}})),d.a.createElement("div",{className:"p-clearfix excludeSelect"},t,d.a.createElement("div",{className:"excludeSelect",style:{fontSize:"16px"}},e.name))}},{key:"onDropdownClick",value:function(e,t){this.refs["autocomplete-candidate-"+t].search(e,"","dropdown"),e.stopPropagation()}},{key:"onUnselect",value:function(e,t){if(8===e.nativeEvent.keyCode&&i.selected){this.setState(function(){var e={};return e[re+t]=i.name,e})}}},{key:"onAutocompleteChange",value:function(e,t){var a=e.value.name;e.value.id&&(te(e)?(F(e.value,ne),e.value.selected=!0):a=" _________________________");var n=this.state[re+t];if(n&&(i=this.props.config.filter(function(e){return e.name===n})[0])&&te({value:i})){var r=this.chosenCandidates.indexOf(n);this.chosenCandidates.splice(r,1),this.props.config.forEach(function(e){e.name===n&&(e.selected=!1,K(e,ne))})}this.setState(function(){var e={};return e[re+t]=a,this.chosenCandidates.push(a),e})}},{key:"render",value:function(){var e=this,t=[];if(this.props.config.length>0)for(var a=function(a){t.push(d.a.createElement(k.a,{className:"excludeSelect",key:"autocomplete-"+re+"-"+a,ref:"autocomplete-"+re+"-"+a,value:e.state[re+a],suggestions:e.state.filteredCandidates,completeMethod:e.filterCandidates,size:30,minLength:1,placeholder:a+1+" _________________________",itemTemplate:e.itemTemplate.bind(e),selectedItemTemplate:function(e){return a+1+" "+e},onClick:function(t){e.onDropdownClick(t,a)},onChange:function(t){return e.onAutocompleteChange(t,a)},onKeyUp:function(t){return e.onUnselect(t,a)}}))},n=0;n<this.props.maxcandidates;n++)a(n);return d.a.createElement("div",{className:"candidates"},t)}}]),t}(p.Component),oe=a(67),ce=a.n(oe),le=(a(155),a(30)),pe=a(24),de=(a(60),a(158),a(56)),ue=function(e){function t(){return Object(m.a)(this,t),Object(g.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(f.a)(t,[{key:"onSelect",value:function(e){s=[],e.files[0].objectURL&&X(e.files[0].objectURL,this.props.party)}},{key:"onRemove",value:function(e){"undefined"!==typeof e.stopPropagation&&e.stopPropagation(),s&&s.length>0&&(s.pop(),this.props.party.setState({image:""})),e.file&&(e.file=null,this.props.party.setState({image:""}))}},{key:"show",value:function(){if(this.props.party.state.opened){var e=this.props.party.props.party;s=e.image?[Z(e)]:[],this.props.party.setState({opened:!1})}}},{key:"componentDidMount",value:function(){this.show()}},{key:"componentDidUpdate",value:function(){this.show()}},{key:"emptyTemplate",value:function(){if(s&&s.length>0)return d.a.createElement(d.a.Fragment,null,d.a.createElement("div",{role:"progressbar",className:"p-progressbar p-component p-progressbar-determinate","aria-valuemin":"0","aria-valuenow":"0","aria-valuemax":"100"},d.a.createElement("div",{className:"p-progressbar-value p-progressbar-value-animate",style:{width:"0%",display:"block"}})),d.a.createElement("div",null,d.a.createElement("div",null)),d.a.createElement("div",{className:"p-fileupload-files"},d.a.createElement("div",{className:"p-fileupload-row"},d.a.createElement("div",null,d.a.createElement("img",{alt:"party",role:"presentation",src:"data:image/jpeg;base64,".concat(r.props.parent.props.party.state.image),width:"150"})),d.a.createElement("div",{className:"p-fileupload-filename"}),d.a.createElement("div",null,Q(s)),d.a.createElement("div",null,d.a.createElement(E.a,{className:"p-button p-component p-button-icon-only",onClick:function(e){return r.props.parent.onRemove(e)}},d.a.createElement("span",{className:"p-button-icon p-c pi pi-times"}),d.a.createElement("span",{className:"p-button-label p-c"},"\xa0"))))))}},{key:"render",value:function(){var e=this;return d.a.createElement(y.a,{id:"app.admin.error.file.detail",defaultMessage:"Maximum dimension is {0}."},function(t){return r=d.a.createElement(de.a,{accept:e.props.accept,maxFileSize:e.props.maxFileSize,emptyTemplate:e.emptyTemplate,chooseLabel:e.props.chooseLabel,previewWidth:e.props.previewWidth,onSelect:function(t){return e.onSelect(t)},parent:e,invalidFileSizeMessageSummary:"",invalidFileSizeMessageDetail:t+"",onRemove:function(t){return e.onRemove(t)}})})}}]),t}(d.a.Component),me=function(e,t){var a=e.votingPaper.value;return a&&a.label?!a||a.label.length>50?(o({name:"name",message:d.a.createElement(y.a,{id:"app.admin.error.maxname",defaultMessage:"You can specify a maximum length of {number} characters for the name",values:{number:50}})}),!1):a&&("bigger"!==e.type&&"bigger-partygroup"!==e.type||-1!==e.zone)?!a||t.filter(function(e){return e.name.toUpperCase()===a.label.toUpperCase()&&e.id!==a.id}).length>0?(o({name:"name",message:d.a.createElement(y.a,{id:"app.admin.error.existingname",defaultMessage:"The name of the voting paper already exists"})}),!1):!a||t.filter(function(t){return("little-nogroup"===e.type&&"little-nogroup"!==t.type||"little-nogroup"!==e.type&&"little-nogroup"===t.type)&&t.id===a.id}).length>0?(o({name:"name",message:d.a.createElement(y.a,{id:"app.admin.error.littlenogroup",defaultMessage:"You cannot pass from a party voting paper to a group voting paper. Remove and create again the voting paper"})}),!1):!(!a||!function(e){if(e){var t=new Date;return!e.dates||e.dates.length<=0||e.dates.some(function(e){return!e.startingDate||!e.endingDate})?(o({name:"name",message:d.a.createElement(y.a,{id:"app.admin.error.dateempty",defaultMessage:"Dates must not be empty",values:{name:e.label}})}),!1):e.dates.some(function(e){return e.endingDate.getTime()<e.startingDate.getTime()})?(o({name:"name",message:d.a.createElement(y.a,{id:"app.admin.error.endingdate.starting",defaultMessage:"Ending date must be older than starting date",values:{name:e.label}})}),!1):!e.dates.every(function(e){return e.endingDate.getTime()<t.getTime()})||(o({name:"name",message:d.a.createElement(y.a,{id:"app.admin.error.endingdate.current",defaultMessage:"Ending date must be older than current date",values:{name:e.label}})}),!1)}return!0}(e)):(o({name:"name",message:d.a.createElement(y.a,{id:"app.admin.error.zonebigger",defaultMessage:"The voting paper must have the zone"})}),!1):(o({name:"name",message:d.a.createElement(y.a,{id:"app.admin.error.name",defaultMessage:"The name of the voting paper is mandatory"})}),!1)},fe=function(e){return e&&e.name?!e||e.name.length>40?(o({name:"name",message:d.a.createElement(y.a,{id:"app.admin.error.maxname",defaultMessage:"You can specify a maximum length of {number} characters for the name",values:{number:40}})}),!1):!(!e||e.votingPaper.type===Se&&e.parties&&("update"===e.state?e.parties.length>2:e.parties.length>=2))||(o({name:"name",message:d.a.createElement(y.a,{id:"app.admin.error.maxsubgroups",defaultMessage:"You can specify a maximum length of {number} subgroups",values:{number:2}})}),!1):(o({name:"name",message:d.a.createElement(y.a,{id:"app.admin.error.party.name",defaultMessage:"The name of the party is mandatory"})}),!1)},ge=function(e){return e&&e.name?!(!e||e.votingPaper.type!==Se&&e.name.length>40)||(o({name:"name",message:d.a.createElement(y.a,{id:"app.admin.error.maxname",defaultMessage:"You can specify a maximum length of {number} characters for the name",values:{number:40}})}),!1):(o({name:"name",message:d.a.createElement(y.a,{id:"app.admin.error.group.name",defaultMessage:"The name of the group is mandatory"})}),!1)},he=function(e,t){return e&&e.name?e&&e.sex?!e||e.name.length>40?(o({name:"name",message:d.a.createElement(y.a,{id:"app.admin.error.maxname",defaultMessage:"You can specify a maximum length of {number} characters for the name",values:{number:40}})}),!1):!e||t.filter(function(t){return t.name.toUpperCase()===e.name.toUpperCase()&&t.id!==e.id}).length>0?(o({name:"name",message:d.a.createElement(y.a,{id:"app.admin.error.candidate.existingname",defaultMessage:"The name of the candidate already exists"})}),!1):!e||e.image&&t.filter(function(t){return t.image===e.image&&t.id!==e.id}).length>0?(o({name:"image",message:d.a.createElement(y.a,{id:"app.admin.error.candidate.existingimage",defaultMessage:"The image of the candidate already exists"})}),!1):!(!e||e.name.length<6||!e.name.includes(" "))||(o({name:"name",message:d.a.createElement(y.a,{id:"app.admin.error.candidate.surname",defaultMessage:"Insert name and surname please"})}),!1):(o({name:"sex",message:d.a.createElement(y.a,{id:"app.admin.error.candidate.sex",defaultMessage:"The sex of the candidate is mandatory"})}),!1):(o({name:"name",message:d.a.createElement(y.a,{id:"app.admin.error.candidate.name",defaultMessage:"The name of the candidate is mandatory"})}),!1)},ve=function(e){function t(){var e;return Object(m.a)(this,t),e=Object(g.a)(this,Object(h.a)(t).call(this)),o=e.errors.bind(Object(b.a)(Object(b.a)(e))),e}return Object(v.a)(t,e),Object(f.a)(t,[{key:"errors",value:function(e){var t={severity:"error",summary:d.a.createElement(y.a,{id:"app.error",defaultMessage:"Error"}),detail:e.message};this.growl.show(t)}},{key:"render",value:function(){var e=this;return d.a.createElement(j.a,{ref:function(t){return e.growl=t}})}}]),t}(p.Component),be=function(e){function t(){var e;return Object(m.a)(this,t),(e=Object(g.a)(this,Object(h.a)(t).call(this))).state={partyName:"",partyTitle:"",image:"",operation:"",opened:!1},e.state.name=d.a.createElement(y.a,{id:"app.configuration.name",defaultMessage:"Name"}),e.state.title=d.a.createElement(y.a,{id:"app.configuration.title",defaultMessage:"Title"}),e.state.chooseImage=d.a.createElement(y.a,{id:"app.configuration.chooseimage",defaultMessage:"Choose Image"}),e.open=e.open.bind(Object(b.a)(Object(b.a)(e))),e.confirm=e.confirm.bind(Object(b.a)(Object(b.a)(e))),e.delete=e.delete.bind(Object(b.a)(Object(b.a)(e))),e.onHide=e.onHide.bind(Object(b.a)(Object(b.a)(e))),e}return Object(v.a)(t,e),Object(f.a)(t,[{key:"open",value:function(){this.props.party.votingPaper.type!==Se?(this.setState({configurationHeader:d.a.createElement(y.a,{id:"app.configuration.headerparty",defaultMessage:"Configure your Party"})}),this.setState({configurationGroupHeader:d.a.createElement(y.a,{id:"app.configuration.headergroup",defaultMessage:"Configure your Group"})}),this.setState({configurationInsertPartyHeader:d.a.createElement(y.a,{id:"app.configuration.headerinsertparty",defaultMessage:"Insert your Party"})}),this.setState({configurationInsertGroupHeader:d.a.createElement(y.a,{id:"app.configuration.headerinsertgroup",defaultMessage:"Insert your Group"})})):(this.setState({configurationHeader:d.a.createElement(y.a,{id:"app.configuration.referendum.headerparty",defaultMessage:"Configure your Vote"})}),this.setState({configurationGroupHeader:d.a.createElement(y.a,{id:"app.configuration.referendum.headergroup",defaultMessage:"Configure your Referendum"})}),this.setState({configurationInsertPartyHeader:d.a.createElement(y.a,{id:"app.configuration.referendum.headerinsertparty",defaultMessage:"Insert your Vote"})}),this.setState({configurationInsertGroupHeader:d.a.createElement(y.a,{id:"app.configuration.referendum.headerinsertgroup",defaultMessage:"Insert your Referendum"})})),this.setState({visible:!0})}},{key:"confirm",value:function(){var e={name:this.state.partyName,subtitle:this.state.partyTitle,image:this.state.image,votingPaper:this.props.votingPaper.props.config,parties:this.props.party.parties,state:this.state.operation};if("update"===this.state.operation)(H(this.props.party)&&fe(e)||U(this.props.party)&&ge(e))&&(this.props.party.name=e.name,this.props.party.subtitle=e.subtitle,this.props.party.image=e.image,this.setState({visible:!1}),this.props.votingPaper.forceUpdate());else if(!this.props.party.name&&ge(e)||this.props.party.name&&fe(e)){var t=W();e.id=t,this.props.party.name?this.props.party.parties.push(e):this.props.party.votingPaper.groups?(e.parties=[],this.props.party.votingPaper.groups.push(e)):this.props.party.votingPaper.parties.push(e),this.setState({visible:!1}),this.props.votingPaper.forceUpdate()}}},{key:"delete",value:function(){var e=q(this.props.party);if(H(this.props.party)){var t=e.parties.map(function(e){return e.id}).indexOf(this.props.party.id);e.parties.splice(t,1)}else{var a=e.groups.map(function(e){return e.id}).indexOf(this.props.party.id);e.groups.splice(a,1)}this.setState({visible:!1}),this.props.votingPaper.forceUpdate()}},{key:"onHide",value:function(){this.setState({visible:!1})}},{key:"render",value:function(){var e=this,t="";this.props.party&&"update"===this.state.operation&&(t=d.a.createElement(y.a,{id:"app.delete",defaultMessage:"Delete"},function(t){return d.a.createElement(E.a,{label:t[0],icon:"pi pi-check",onClick:e.delete,className:"confirm"})}));var a=d.a.createElement("div",null,d.a.createElement(y.a,{id:"app.confirm",defaultMessage:"Confirm"},function(t){return d.a.createElement(E.a,{label:t[0],icon:"pi pi-check",onClick:e.confirm,className:"confirm"})}),t,d.a.createElement(y.a,{id:"app.cancel",defaultMessage:"Cancel"},function(t){return d.a.createElement(E.a,{label:t[0],icon:"pi pi-times",onClick:e.onHide,className:"p-button-secondary confirm"})})),n="";n=H(this.props.party)?"update"===this.state.operation?this.state.configurationHeader:this.state.configurationInsertHeader:"update"===this.state.operation?this.state.configurationGroupHeader:this.props.party.name||"little-nogroup"===this.props.party.votingPaper.type?this.state.configurationInsertPartyHeader:this.state.configurationInsertGroupHeader;var i=!1;"insert"!==this.state.operation||this.state.partyName||(i=!0);var r={autoFocus:i},s=d.a.createElement(pe.a,Object.assign({},r,{value:this.state.partyName,onChange:function(t){return e.setState({partyName:t.target.value})},onKeyPress:function(t){"Enter"===t.nativeEvent.key&&e.confirm()}}));return d.a.createElement(le.a,{contentStyle:{maxHeight:"600px",width:"360px"},header:n,visible:this.state.visible,footer:a,onHide:this.onHide,className:"modal-party"},d.a.createElement("div",{className:"grid"},d.a.createElement("div",{className:"col"},this.state.name),d.a.createElement("div",{className:"col"},s)),d.a.createElement("div",{className:"grid"},d.a.createElement("div",{className:"col"},this.state.title),d.a.createElement("div",{className:"col"},d.a.createElement(pe.a,{ref:function(t){e.title=t},value:this.state.partyTitle?this.state.partyTitle:"",onChange:function(t){return e.setState({partyTitle:t.target.value})}}))),d.a.createElement("div",{className:"grid"},d.a.createElement("div",{className:"col"},d.a.createElement(y.a,{id:"app.configuration.chooseimage",defaultMessage:"Choose Image"},function(t){return d.a.createElement(ue,{accept:"image/*",maxFileSize:6e4,chooseLabel:t[0],party:e,previewWidth:150})}))))}}]),t}(p.Component),ye=a(68),Ee=a(53),ke=(a(160),function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(g.a)(this,Object(h.a)(t).call(this,e))).fileUpload=Object(p.createRef)(),l=[],a}return Object(v.a)(t,e),Object(f.a)(t,[{key:"onSelect",value:function(e){e.files[0].objectURL&&X(e.files[0].objectURL,this.parent.props.party)}},{key:"onRemove",value:function(e){"undefined"!==typeof e.stopPropagation&&e.stopPropagation(),l&&l.length>0&&(l.pop(),this.props.party.setState({image:""})),this.fileUpload.current.clear(),e.file&&(e.file=null,this.props.party.setState({image:""}))}},{key:"componentDidUpdate",value:function(){if(this.props.party.state.opened){var e=this.props.candidate;l=e&&e.image?[Z(e)]:[],this.fileUpload.current&&this.fileUpload.current.clear(),this.props.party.setState({opened:!1})}}},{key:"emptyTemplate",value:function(){if(l&&l.length>0)return d.a.createElement(d.a.Fragment,null,d.a.createElement("div",{role:"progressbar",className:"p-progressbar p-component p-progressbar-determinate","aria-valuemin":"0","aria-valuenow":"0","aria-valuemax":"100"},d.a.createElement("div",{className:"p-progressbar-value p-progressbar-value-animate",style:{width:"0%",display:"block"}})),d.a.createElement("div",null,d.a.createElement("div",null)),d.a.createElement("div",{className:"p-fileupload-files"},d.a.createElement("div",{className:"p-fileupload-row"},d.a.createElement("div",null,d.a.createElement("img",{alt:"candidate",role:"presentation",src:"data:image/jpeg;base64,".concat(c.props.parent.props.party.state.image),width:"150"})),d.a.createElement("div",{className:"p-fileupload-filename"}),d.a.createElement("div",null,Q(l)),d.a.createElement("div",null,d.a.createElement(E.a,{className:"p-button p-component p-button-icon-only",onClick:function(e){return c.props.parent.onRemove(e)}},d.a.createElement("span",{className:"p-button-icon p-c pi pi-times"}),d.a.createElement("span",{className:"p-button-label p-c"},"\xa0"))))))}},{key:"render",value:function(){var e=d.a.createElement(y.a,{id:"app.admin.error.file.detail",defaultMessage:"Maximum dimension is {0}."});return c=d.a.createElement(de.a,{ref:this.fileUpload,accept:this.props.accept,maxFileSize:this.props.maxFileSize,onSelect:this.onSelect,chooseLabel:this.props.chooseLabel,previewWidth:this.props.previewWidth,emptyTemplate:this.emptyTemplate,invalidFileSizeMessageSummary:"",invalidFileSizeMessageDetail:e+"",parent:this})}}]),t}(d.a.Component)),je=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(g.a)(this,Object(h.a)(t).call(this,e))).state={id:"",name:"",sex:"",image:"",candidate:{},candidates:[],generateId:"",opened:!1},a.candidateUpload=Object(p.createRef)(),a.candidatesDialog=Object(p.createRef)(),a.boxCandidates=Object(p.createRef)(),a.nameInputText=Object(p.createRef)(),a.state.configurationHeader=d.a.createElement(y.a,{id:"app.configuration.headercandidates",defaultMessage:"Manage candidates"}),a.state.namesurnameLabel=d.a.createElement(y.a,{id:"app.configuration.namesurname",defaultMessage:"Name and surname"}),a.state.genderLabel=d.a.createElement(y.a,{id:"app.configuration.gender",defaultMessage:"Gender"}),a.state.chooseImage=d.a.createElement(y.a,{id:"app.configuration.chooseimage",defaultMessage:"Choose Image"}),a.open=a.open.bind(Object(b.a)(Object(b.a)(a))),a.confirm=a.confirm.bind(Object(b.a)(Object(b.a)(a))),a.onHide=a.onHide.bind(Object(b.a)(Object(b.a)(a))),a.imgTemplate=a.imgTemplate.bind(Object(b.a)(Object(b.a)(a))),a}return Object(v.a)(t,e),Object(f.a)(t,[{key:"open",value:function(){var e=this.props.party,t=[];e.candidates&&e.candidates.forEach(function(e){t.push({label:e.name,value:e.id,id:e.id,name:e.name,image:e.image,sex:e.sex})});var a=T.getRoles().includes("admin"),n=parseInt(ut.profile.attributes.block[0],10),i=a||_(z(e.id),n);this.setState({id:"",sex:"",image:"",name:"",candidates:t,visible:!0,partyEnabled:i,isAdmin:a,block:n})}},{key:"confirm",value:function(){this.props.party.candidates=this.state.candidates,this.props.partyComponent.forceUpdate(),this.setState({visible:!1})}},{key:"onHide",value:function(){this.setState({visible:!1})}},{key:"imgTemplate",value:function(e){var t=this.state.candidates.filter(function(t){return t.id===parseInt(e.value,10)})[0].image;return d.a.createElement("div",{className:"p-clearfix"},d.a.createElement("img",{alt:e.label,src:"data:image/jpeg;base64,".concat(t),style:{display:"inline-block",margin:"5px 0 0 5px",width:48}}),d.a.createElement("span",{style:{fontSize:"1.3em",float:"right",margin:"1em .5em 0 0"}},e.label))}},{key:"render",value:function(){var e=this,t=this.state.candidates.filter(function(t){return t.id===e.state.id})[0],a=d.a.createElement("div",null,d.a.createElement(y.a,{id:"app.confirm",defaultMessage:"Confirm"},function(t){return d.a.createElement(E.a,{label:t[0],icon:"pi pi-check",onClick:e.confirm,className:"confirm"})}),d.a.createElement(y.a,{id:"app.cancel",defaultMessage:"Cancel"},function(t){return d.a.createElement(E.a,{label:t[0],icon:"pi pi-times",onClick:e.onHide,className:"p-button-secondary confirm"})})),n=this.state.isAdmin||_(z(this.state.id),this.state.block),i=d.a.createElement("div",{className:"grid"},d.a.createElement("div",{className:"col"},d.a.createElement(y.a,{id:"app.configuration.chooseimage",defaultMessage:"Choose Image"},function(a){return d.a.createElement(ke,{ref:e.candidateUpload,accept:"image/*",maxFileSize:6e4,chooseLabel:a[0],party:e,candidate:t,previewWidth:150,disabled:!n})})));return d.a.createElement(le.a,{ref:this.candidatesDialog,contentStyle:{maxHeight:"700px",width:"360px"},header:this.state.configurationHeader,visible:this.state.visible,footer:a,onHide:this.onHide,className:"modal-candidates"},d.a.createElement("div",{className:"grid"},d.a.createElement("div",{className:"col"},this.state.namesurnameLabel),d.a.createElement("div",{className:"col"},d.a.createElement(pe.a,{ref:this.nameInputText,value:this.state.name,disabled:!n,onChange:function(t){e.setState({name:t.target.value})}}))),d.a.createElement("div",{className:"grid"},d.a.createElement("div",{className:"col"},this.state.genderLabel),d.a.createElement("div",{className:"col"},$,d.a.createElement(ye.a,{value:$,name:"sex",onChange:function(t){return e.setState({sex:t.value})},checked:this.state.sex===$,disabled:!n}),ee,d.a.createElement(ye.a,{value:ee,name:"sex",onChange:function(t){return e.setState({sex:t.value})},checked:this.state.sex===ee,disabled:!n}))),i,d.a.createElement("hr",{style:{background:"#fff"}}),d.a.createElement("div",{className:"grid"},d.a.createElement("div",{className:"col admin-candidates"},d.a.createElement(y.a,{id:"app.insert",defaultMessage:"Insert"},function(t){return d.a.createElement(E.a,{disabled:!e.state.partyEnabled,label:t[0],icon:"pi pi-check",onClick:function(){var t={name:e.state.name,sex:e.state.sex,image:e.state.image,label:e.state.name};if(he(t,e.state.candidates)){var a=e.state.generateId;a||(a=W()),e.setState({generateId:a+1}),t.id=a,t.value=a,e.state.candidates.push(t)}},className:"confirm"})}),d.a.createElement(y.a,{id:"app.update",defaultMessage:"Update"},function(t){return d.a.createElement(E.a,{disabled:!n,label:t[0],icon:"pi pi-check",onClick:function(){var t={id:e.state.id,name:e.state.name,sex:e.state.sex,image:e.state.image,label:e.state.name};he(t,e.state.candidates)&&e.state.candidates.forEach(function(t){t.value===e.state.id&&(t.label=e.state.name,t.id=e.state.id,t.name=e.state.name,t.image=e.state.image,t.sex=e.state.sex)})},className:"confirm"})}),d.a.createElement(y.a,{id:"app.delete",defaultMessage:"Delete"},function(t){return d.a.createElement(E.a,{disabled:!e.state.partyEnabled,label:t[0],icon:"pi pi-check",onClick:function(){var t=e.state.candidates.map(function(e){return e.id}).indexOf(e.state.id);e.state.candidates.splice(t,1),e.setState({id:"",name:"",image:"",sex:""}),e.candidateUpload.current.onRemove({})},className:"confirm"})}))),d.a.createElement("div",{className:"grid"},d.a.createElement("div",{className:"col"},d.a.createElement(Ee.a,{ref:this.boxCandidates,value:this.state.id,filter:!0,options:this.state.candidates,onChange:function(t){var a=e.state.candidates.filter(function(e){return e.id===parseInt(t.value,10)})[0];t.value?e.setState({id:t.value,name:a.name,sex:a.sex,image:a.image,opened:!0}):e.setState({id:"",name:"",sex:"",image:"",opened:!0})},itemTemplate:this.imgTemplate,style:{width:"21em"},listStyle:{maxHeight:"250px"}}))))}}]),t}(p.Component),Oe=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(g.a)(this,Object(h.a)(t).call(this,e))).state={},a.modalInsertParty=d.a.createRef(),a.modalParty=d.a.createRef(),a.modalCandidates=d.a.createRef(),a}return Object(v.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e=this;if("PREPARE"===ut.state){var t={color:"#"+this.props.party.votingPaper.color},a="",n="",i="",r=T.getRoles().includes("admin"),s=parseInt(ut.profile.attributes.block[0],10),o=r||_(this.props.party,s),c=r||function e(t,a){if(t.id===a)return!0;var n=t.groups,i=t.parties,r=t.candidates;if(n)for(var s=0;s<n.length;s++)return e(n[s],a);else if(i)for(var o=0;o<i.length;o++)return e(i[o],a);else if(r)for(var c=0;c<r.length;c++)return e(r[c],a);return!1}(this.props.party,s),l=U(this.props.party);if(o){if(l||!this.props.party.name){var p="";this.props.party.name||(p=" voting-paper-admin"),a=d.a.createElement(E.a,{icon:"pi pi-plus",className:"admin-button"+p,style:t,onClick:function(t){t.stopPropagation(),e.modalInsertParty.current.setState({partyName:"",partyTitle:"",image:"",operation:"insert",opened:!0}),e.modalInsertParty.current.open()}})}this.props.party.name&&(n=d.a.createElement(E.a,{icon:"pi pi-briefcase",className:"admin-button",style:t,onClick:function(t){t.stopPropagation(),e.modalParty.current.setState({partyName:e.props.party.name,partyTitle:e.props.party.subtitle,image:e.props.party.image,operation:"update",opened:!0}),e.modalParty.current.open()}}))}return(o||c)&&this.props.party.name&&!l&&this.props.party.votingPaper.maxCandidates&&this.props.party.votingPaper.maxCandidates>0&&(i=d.a.createElement(E.a,{icon:"pi pi-users",className:"admin-button",style:t,onClick:function(t){t.stopPropagation(),e.modalCandidates.current.setState({operation:"update",opened:!0}),e.modalCandidates.current.open()}})),d.a.createElement("div",{className:"admin-buttons"},d.a.createElement(be,{ref:this.modalParty,party:this.props.party,votingPaper:this.props.votingPaper}),d.a.createElement(be,{ref:this.modalInsertParty,party:this.props.party,votingPaper:this.props.votingPaper}),d.a.createElement(je,{ref:this.modalCandidates,partyComponent:this.props.partyComponent,party:this.props.party,votingPaper:this.props.votingPaper}),n,a,i)}return""}}]),t}(p.Component),Ce=a(101),Pe=a.n(Ce),Ne=(a(162),a(1)),we="group",xe="party",Se="referendum",Me=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(g.a)(this,Object(h.a)(t).call(this,e))).adminButtons=d.a.createRef(),a}return Object(v.a)(t,e),Object(f.a)(t,[{key:"putX",value:function(e){if((!this.adminButtons.current.modalParty.current&&!this.adminButtons.current.modalInsertParty.current&&!this.adminButtons.current.modalCandidates.current||!this.adminButtons.current.modalParty.current.state.visible&&!this.adminButtons.current.modalInsertParty.current.state.visible&&!this.adminButtons.current.modalCandidates.current.state.visible)&&(e.value=this.props.party,!e.target.classList.contains("excludeSelect")&&te(e))){e.value.selected?K(e.value,ne):F(e.value,ne);var t=this.props.party.name;this.props.party.subtitle&&(t=t+" "+this.props.party.subtitle),this.selectedItem?(this.selectedItem=null,e.value.selected=!1):(this.selectedItem=d.a.createElement("img",{className:"button-selected",alt:t,src:Pe.a}),e.value.selected=!0),this.forceUpdate()}}},{key:"renderIcon",value:function(){if(this.props.icon){var e=ce()(this.props.icon,"p-c",{"p-button-icon-left":!0,"p-button-icon-right":!1}),t=this.props.party.name;return this.props.party.subtitle&&(t=t+" "+this.props.party.subtitle),d.a.createElement("span",{className:e},this.props.party.image&&d.a.createElement("img",{alt:t,src:"data:image/jpeg;base64,".concat(this.props.party.image)}),this.selectedItem)}return this.selectedItem}},{key:"renderLabel",value:function(){if(0===this.props.votingpaper.props.config.maxCandidates||this.props.party.name&&(!this.props.party.candidates||0===this.props.party.candidates.length)){var e=this.props.party.name||"p-btn",t="";"undefined"!==this.props.party.subtitle&&(t=this.props.party.subtitle);var a="";return"referendum"!==this.props.party.votingPaper.type&&(a=d.a.createElement("span",{className:"p-button-subtext p-c"},t)),d.a.createElement("span",{className:"p-button-text p-c"},e,a)}}},{key:"renderSubLabel",value:function(){var e="";if("referendum"===this.props.party.votingPaper.type){var t="";"undefined"!==this.props.party.subtitle&&(t=this.props.party.subtitle),e=d.a.createElement("div",{className:"p-button-subtext p-c"},t)}return e}},{key:"renderCandidates",value:function(){if(this.props.party.candidates)return d.a.createElement(se,{config:this.props.party.candidates,maxcandidates:R(this.props.party).maxCandidates})}},{key:"render",value:function(){var e=this;this.props.party.type=U(this.props.party)?we:xe,this.props.party.votingPaper=R(this.props.party);var t=ce()("p-button p-component",this.props.className,{"p-button-icon-only":this.props.icon&&!this.props.party.name&&!this.props.party.candidates,"p-button-text-icon-left":this.props.icon&&(this.props.party.name||this.props.party.candidates),"p-button-text-icon-right":!1,"p-button-text-only":!this.props.icon&&(this.props.party.name||this.props.party.candidates),"p-disabled":this.props.disabled}),a=this.renderIcon(),n=this.renderLabel(),i=this.renderSubLabel(),r=this.renderCandidates(),s=Ne.d.findDiffKeys(this.props,E.a.defaultProps);return d.a.createElement(d.a.Fragment,null,d.a.createElement("div",Object.assign({ref:function(t){return e.element=t}},s,{className:t}),d.a.createElement(Oe,{party:this.props.party,partyComponent:this,votingPaper:this.props.votingpaper,ref:this.adminButtons}),a,n,r,this.props.children),i)}}]),t}(d.a.Component),De=(a(164),a(166),a(168),a(170),function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(g.a)(this,Object(h.a)(t).call(this,e))).jsonData=e,a}return Object(v.a)(t,e),Object(f.a)(t,[{key:"renderTitle",value:function(){var e="";return this.jsonData.config.type===Se&&(e=d.a.createElement("div",{className:"referendum-title"},d.a.createElement(y.a,{id:"app.configuration.referendum",defaultMessage:"POPULAR REFERENDUM"}))),e}},{key:"renderPartiesByGroup",value:function(e){var t=this;return e.parties.map(function(a){return t.renderParty(e,a)})}},{key:"renderParties",value:function(e){var t=this;if(e)return e.map(function(e){return t.renderParty({id:0},e)})}},{key:"renderParty",value:function(e,t){var a=this,n=Object.assign({});return n.key="party-"+e.id+"-"+t.id,n.icon="pi",n.className="p-button-secondary second-row",n.party=t,n.ref=n.key,n.id=n.key,n.votingpaper=this,d.a.createElement(Me,Object.assign({},n,{onClick:function(e){a.refs[n.ref].putX(e)}}))}},{key:"renderGroup",value:function(e){var t=this;if(e.name){var a,n={gridRow:"1 / "+(e.parties.length+1)},i="";e.parties.length>1&&(i="is-grid"),e.image&&(a="pi");var r=Object.assign({});return r.key="group-"+e.id,r.icon=a,r.party=e,r.className="p-button-secondary first-row "+i,r.style=n,r.ref=r.key,r.id=r.key,r.votingpaper=this,this.jsonData.config.type===Se?("PREPARE"!==ut.state&&(r.disabled=!0),d.a.createElement(Me,r)):d.a.createElement(Me,Object.assign({},r,{onClick:function(e){t.refs[r.ref].putX(e)}}))}}},{key:"render",value:function(){var e=this;if(this.props.visible){var t=this.renderTitle();return this.jsonData.config.groups?d.a.createElement("div",{className:"page"},t,this.jsonData.config.groups.map(function(t,a){var n,i;return n=e.renderPartiesByGroup(t),i=e.renderGroup(t),d.a.createElement("div",{key:"parties-"+a,className:"content-party resize-"+a%2},i,n)}),d.a.createElement(Oe,{party:{votingPaper:this.props.config},votingPaper:this,ref:"vt-admin-buttons"})):d.a.createElement("div",{className:"page"},d.a.createElement("div",{key:"parties-0",className:"content-party resize-0"},this.renderParties(this.jsonData.config.parties)),d.a.createElement(Oe,{party:{votingPaper:this.props.config},votingPaper:this,ref:"vt-admin-buttons"}))}return d.a.createElement("div",{className:"page"})}}]),t}(p.Component)),Ie=(a(172),a(55)),Te=a(33),_e=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(g.a)(this,Object(h.a)(t).call(this,e))).state={},a.state.confirmHeader=d.a.createElement(y.a,{id:"app.confirm.header",defaultMessage:"Confirm your vote"}),a.state.confirmBody=d.a.createElement(y.a,{id:"app.confirm.body",defaultMessage:"By clicking on (Yes) you will confirm the sending of the data. Once confirmed you will not be able to go back. Confirm the rescue?"}),a.open=a.open.bind(Object(b.a)(Object(b.a)(a))),a.errors=a.errors.bind(Object(b.a)(Object(b.a)(a))),a.confirm=a.confirm.bind(Object(b.a)(Object(b.a)(a))),a.onHide=a.onHide.bind(Object(b.a)(Object(b.a)(a))),a.show=a.show.bind(Object(b.a)(Object(b.a)(a))),a}return Object(v.a)(t,e),Object(f.a)(t,[{key:"open",value:function(){this.setState({visible:!0})}},{key:"errors",value:function(e){var t=d.a.createElement(y.a,{id:"app.error",defaultMessage:"Error"});this.props.window.refs.validator.growl.show({severity:"error",summary:t,detail:e.message})}},{key:"createVote",value:function(){var e={votingPapers:[]};return ut.votingPapers.forEach(function(t){return e.votingPapers.push({id:t.id})}),ne.forEach(function(t){for(var a=t.votingPaper,n={},i={},r=0;r<e.votingPapers.length;r++)e.votingPapers[r].id===a.id&&(n=e.votingPapers[r]);n.id||0===n.id||(n.id=a.id,e.votingPapers.push(n)),t.type===we&&t.votingPaper.type!==Se?n.group={id:t.id}:t.type===xe?(n.parties||(n.parties=[]),i.id=t.id,n.parties.push(i)):t.type===re&&(i.candidates||(i.candidates=[]),i.candidates.push({id:t.id}))}),e}},{key:"confirm",value:function(){var e=this;T.updateToken().then(function(){T.axiosInstance.defaults.headers.common.Authorization="Bearer "+T.getToken(),e.doConfirm()})}},{key:"doConfirm",value:function(){var e=this,t=C.a.findDOMNode(this).querySelectorAll(".pi-check")[0];t.className="pi pi-spin pi-spinner p-c p-button-icon-left",T.axiosInstance.post("https://vota-voting.vige.it:8443/vote",this.createVote()).then(function(a){return t.className="pi pi-check p-c p-button-icon-left",e.setState({visible:!1}),e.props.window.setState({visible:!1}),a}).catch(function(a){t.className="pi pi-check p-c p-button-icon-left",e.errors(a)})}},{key:"onHide",value:function(){this.setState({visible:!1})}},{key:"show",value:function(){var e=C.a.findDOMNode(this);if(e){var t=e.getElementsByClassName("p-rowgroup-header");ut.votingPapers.forEach(function(e){for(var a=0;a<t.length;a++)t[a]&&t[a].innerHTML.indexOf('id="'+e.id)>=0&&(t[a].style.setProperty("background-color","#"+e.color),t[a].style.setProperty("border-color","#"+e.color))})}}},{key:"headerTemplate",value:function(e){return d.a.createElement("span",{className:"voting-paper-field",id:e.votingPaper.id},e.votingPaper.name)}},{key:"footerTemplate",value:function(e){return[d.a.createElement("td",{key:e.votingPaper.name+"_footerTotalLabel",colSpan:"2"})]}},{key:"sortByElement",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"ascending",n=e.votingPaper.id-t.votingPaper.id+e.type.toLowerCase().localeCompare(t.type.toLowerCase());return"ascending"===a?n:-1*n}},{key:"sort",value:function(e){var t=this;return e.sort(function(e,a){return t.sortByElement(e,a,"descending")})}},{key:"render",value:function(){var e=this,t=d.a.createElement("div",null,d.a.createElement(y.a,{id:"app.yes",defaultMessage:"Yes"},function(t){return d.a.createElement(E.a,{label:t[0],icon:"pi pi-check",onClick:e.confirm,className:"confirm"})}),d.a.createElement(y.a,{id:"app.no",defaultMessage:"No"},function(t){return d.a.createElement(E.a,{label:t[0],icon:"pi pi-times",onClick:e.onHide,className:"p-button-secondary confirm"})}));return d.a.createElement(le.a,{className:"confirm-vote",contentStyle:{maxHeight:"500px"},header:this.state.confirmHeader,visible:this.state.visible,footer:t,onHide:this.onHide,onShow:this.show},this.state.confirmBody,d.a.createElement("br",null),d.a.createElement("br",null),d.a.createElement(y.a,{id:"app.confirm.norecordsfound",defaultMessage:"Empty selection"},function(t){return d.a.createElement(Ie.a,{value:e.sort(ne),rowGroupMode:"subheader",sortField:"votingPaper",sortOrder:1,groupRowsBy:"votingPaper",rowGroupHeaderTemplate:e.headerTemplate,rowGroupFooterTemplate:e.footerTemplate,emptyMessage:t[0]},d.a.createElement(Te.a,{body:function(e){return e.votingPaper.type===Se?d.a.createElement("b",null,e.name):d.a.createElement("b",null,d.a.createElement(y.a,{id:"app.confirm."+e.type,defaultMessage:e.type}))}}),d.a.createElement(Te.a,{body:function(e){return e.votingPaper.type===Se?q(e).name:e.name}}))}))}}]),t}(p.Component),Re=a(102),ze=a.n(Re),Le=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(g.a)(this,Object(h.a)(t).call(this,e))).state={},a.state.confirmHeader=d.a.createElement(y.a,{id:"app.confirm.ins.header",defaultMessage:"Confirm your update"}),a.state.confirmBody=d.a.createElement(y.a,{id:"app.confirm.ins.body",defaultMessage:"By clicking on (Yes) you will confirm the sending of the data. Confirm the rescue?"}),a.open=a.open.bind(Object(b.a)(Object(b.a)(a))),a.errors=a.errors.bind(Object(b.a)(Object(b.a)(a))),a.confirm=a.confirm.bind(Object(b.a)(Object(b.a)(a))),a.onHide=a.onHide.bind(Object(b.a)(Object(b.a)(a))),a}return Object(v.a)(t,e),Object(f.a)(t,[{key:"open",value:function(){this.setState({visible:!0})}},{key:"errors",value:function(e){this.props.window.refs.ruler.errors({message:e.message})}},{key:"doConfirm",value:function(){var e=this,t=JSON.parse(ze()(ut)),a=C.a.findDOMNode(this).querySelectorAll(".pi-check")[0];a.className="pi pi-spin pi-spinner p-c p-button-icon-left",T.axiosInstance.post("https://vota-votingpapers.vige.it:8543/votingPapers",t).then(function(t){return a.className="pi pi-check p-c p-button-icon-left",e.setState({visible:!1}),t}).catch(function(t){e.errors(t),a.className="pi pi-check p-c p-button-icon-left",console.log(t)})}},{key:"confirm",value:function(){var e=this;T.updateToken().then(function(){T.axiosInstance.defaults.headers.common.Authorization="Bearer "+T.getToken(),e.doConfirm()})}},{key:"onHide",value:function(){this.setState({visible:!1})}},{key:"render",value:function(){var e=this,t=d.a.createElement("div",null,d.a.createElement(y.a,{id:"app.yes",defaultMessage:"Yes"},function(t){return d.a.createElement(E.a,{label:t[0],icon:"pi pi-check",onClick:e.confirm,className:"confirm"})}),d.a.createElement(y.a,{id:"app.no",defaultMessage:"No"},function(t){return d.a.createElement(E.a,{label:t[0],icon:"pi pi-times",onClick:e.onHide,className:"p-button-secondary confirm"})}));return d.a.createElement(le.a,{contentStyle:{maxHeight:"500px"},header:this.state.confirmHeader,visible:this.state.visible,footer:t,onHide:this.onHide},this.state.confirmBody,d.a.createElement("br",null),d.a.createElement("br",null))}}]),t}(p.Component),He=a(103),Ue=a(54),Ae=a(104),Fe=a(57),Be=a(113),We=a(44),Ge=a(105),Ye=a(3),Ve=(a(174),navigator.language.split(/[-_]/)[0]),Je=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(g.a)(this,Object(h.a)(t).call(this,e))).emptyDate={id:null,startingDate:null,endingDate:null},a.state={dates:null,dateDialog:!1,date:a.emptyDate,submitted:!1},Object(Ye.d)(Ve,{firstDayOfWeek:1,dayNamesMin:[d.a.createElement(y.a,{id:"app.admin.dates.weeks.sunday",defaultMessage:"Su"}),d.a.createElement(y.a,{id:"app.admin.dates.weeks.monday",defaultMessage:"Mo"}),d.a.createElement(y.a,{id:"app.admin.dates.weeks.tuesday",defaultMessage:"Tu"}),d.a.createElement(y.a,{id:"app.admin.dates.weeks.wednesday",defaultMessage:"We"}),d.a.createElement(y.a,{id:"app.admin.dates.weeks.thursday",defaultMessage:"Th"}),d.a.createElement(y.a,{id:"app.admin.dates.weeks.friday",defaultMessage:"Fr"}),d.a.createElement(y.a,{id:"app.admin.dates.weeks.saturday",defaultMessage:"Sa"})],monthNames:[d.a.createElement(y.a,{id:"app.admin.dates.months.january",defaultMessage:"January"}),d.a.createElement(y.a,{id:"app.admin.dates.months.february",defaultMessage:"February"}),d.a.createElement(y.a,{id:"app.admin.dates.months.march",defaultMessage:"March"}),d.a.createElement(y.a,{id:"app.admin.dates.months.april",defaultMessage:"April"}),d.a.createElement(y.a,{id:"app.admin.dates.months.may",defaultMessage:"May"}),d.a.createElement(y.a,{id:"app.admin.dates.months.june",defaultMessage:"June"}),d.a.createElement(y.a,{id:"app.admin.dates.months.july",defaultMessage:"July"}),d.a.createElement(y.a,{id:"app.admin.dates.months.august",defaultMessage:"August"}),d.a.createElement(y.a,{id:"app.admin.dates.months.september",defaultMessage:"September"}),d.a.createElement(y.a,{id:"app.admin.dates.months.october",defaultMessage:"October"}),d.a.createElement(y.a,{id:"app.admin.dates.months.november",defaultMessage:"November"}),d.a.createElement(y.a,{id:"app.admin.dates.months.december",defaultMessage:"December"})]}),a.state.dateDetailsLabel=d.a.createElement(y.a,{id:"app.configuration.datedetails",defaultMessage:"Date Details"}),a.state.newDateLabel=d.a.createElement(y.a,{id:"app.configuration.newdate",defaultMessage:"New date"}),a.state.startingDateLabel=d.a.createElement(y.a,{id:"app.configuration.startingdate",defaultMessage:"Starting date"}),a.state.endingDateLabel=d.a.createElement(y.a,{id:"app.configuration.endingdate",defaultMessage:"Ending date"}),a.leftToolbarTemplate=a.leftToolbarTemplate.bind(Object(b.a)(Object(b.a)(a))),a.actionBodyTemplate=a.actionBodyTemplate.bind(Object(b.a)(Object(b.a)(a))),a.openNew=a.openNew.bind(Object(b.a)(Object(b.a)(a))),a.hideDialog=a.hideDialog.bind(Object(b.a)(Object(b.a)(a))),a.saveDate=a.saveDate.bind(Object(b.a)(Object(b.a)(a))),a.deleteDate=a.deleteDate.bind(Object(b.a)(Object(b.a)(a))),a.onInputChange=a.onInputChange.bind(Object(b.a)(Object(b.a)(a))),a.startingDateTemplate=a.startingDateTemplate.bind(Object(b.a)(Object(b.a)(a))),a.endingDateTemplate=a.endingDateTemplate.bind(Object(b.a)(Object(b.a)(a))),a}return Object(v.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.setState({dates:this.props.dates.map(function(t){return{id:e.createId(),startingDate:t.startingDate,endingDate:t.endingDate}})})}},{key:"openNew",value:function(){this.setState({date:this.emptyDate,submitted:!1,dateDialog:!0})}},{key:"hideDialog",value:function(){this.setState({submitted:!1,dateDialog:!1})}},{key:"saveDate",value:function(){var e={submitted:!0};if(this.state.date){var t=Object(Be.a)(this.state.dates),a=Object(Fe.a)({},this.state.date);a.id=this.createId(),t.push(a),this.props.dates.push({startingDate:a.startingDate,endingDate:a.endingDate}),e=Object(Fe.a)({},e,{dates:t,dateDialog:!1,date:this.emptyDate})}this.setState(e)}},{key:"startingDateTemplate",value:function(e){var t=this;return d.a.createElement(We.a,{locale:Ve,dateFormat:"dd/mm/yy",showTime:!0,hourFormat:"24",value:e.startingDate,onChange:function(a){e.startingDate=a.value;var n=t.state.dates.indexOf(e);t.props.dates[n].startingDate=a.value,t.setState({date:e})}})}},{key:"endingDateTemplate",value:function(e){var t=this;return d.a.createElement(We.a,{locale:Ve,dateFormat:"dd/mm/yy",showTime:!0,hourFormat:"24",value:e.endingDate,onChange:function(a){e.endingDate=a.value;var n=t.state.dates.indexOf(e);t.props.dates[n].endingDate=a.value,t.setState({date:e})}})}},{key:"deleteDate",value:function(e){var t=this.state.dates.indexOf(e);this.props.dates.splice(t,1);var a=this.state.dates.filter(function(t){return t.id!==e.id});this.setState({dates:a,date:this.emptyDate})}},{key:"findIndexById",value:function(e){for(var t=-1,a=0;a<this.state.dates.length;a++)if(this.state.dates[a].id===e){t=a;break}return t}},{key:"createId",value:function(){for(var e="",t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",a=0;a<5;a++)e+=t.charAt(Math.floor(Math.random()*t.length));return e}},{key:"onInputChange",value:function(e,t){var a=e.target&&e.target.value||"",n=Object(Fe.a)({},this.state.date);n["".concat(t)]=a,this.setState({date:n})}},{key:"leftToolbarTemplate",value:function(){return d.a.createElement(E.a,{label:this.state.newDateLabel,icon:"pi pi-plus",className:"confirm",onClick:this.openNew})}},{key:"actionBodyTemplate",value:function(e){var t=this;return d.a.createElement(E.a,{icon:"pi pi-trash",className:"p-button-rounded p-button-warning",onClick:function(){return t.deleteDate(e)}})}},{key:"render",value:function(){var e=this,t=d.a.createElement(d.a.Fragment,null,d.a.createElement(y.a,{id:"app.confirm",defaultMessage:"Confirm"},function(t){return d.a.createElement(E.a,{label:t[0],icon:"pi pi-check",onClick:e.saveDate,className:"confirm"})}),d.a.createElement(y.a,{id:"app.cancel",defaultMessage:"Cancel"},function(t){return d.a.createElement(E.a,{label:t[0],icon:"pi pi-times",onClick:e.hideDialog,className:"p-button-secondary confirm"})}));return d.a.createElement("div",{className:"datatable-crud-dates"},d.a.createElement("div",{className:"card"},d.a.createElement(Ge.a,{className:"p-mb-4",left:this.leftToolbarTemplate}),d.a.createElement(y.a,{id:"app.admin.nodatesfound",defaultMessage:"No dates"},function(t){return d.a.createElement(Ie.a,{ref:function(t){return e.dt=t},value:e.state.dates,dataKey:"id",emptyMessage:t[0]},d.a.createElement(Te.a,{field:"startingDate",header:e.state.startingDateLabel,body:e.startingDateTemplate,style:{width:"8.6rem"}}),d.a.createElement(Te.a,{field:"endingDate",header:e.state.endingDateLabel,body:e.endingDateTemplate,style:{width:"8.6rem"}}),d.a.createElement(Te.a,{body:e.actionBodyTemplate,exportable:!1}))})),d.a.createElement(le.a,{visible:this.state.dateDialog,header:this.state.dateDetailsLabel,modal:!0,className:"p-fluid",footer:t,onHide:this.hideDialog},d.a.createElement("div",{className:"grid"},d.a.createElement("div",{className:"col"},this.state.startingDateLabel),d.a.createElement("div",{className:"col date-modal"},d.a.createElement(We.a,{locale:Ve,dateFormat:"dd/mm/yy",showTime:!0,hourFormat:"24",value:this.state.date.startingDate,onChange:function(t){return e.onInputChange(t,"startingDate")}}))),d.a.createElement("div",{className:"grid"},d.a.createElement("div",{className:"col"},this.state.endingDateLabel),d.a.createElement("div",{className:"col date-modal"},d.a.createElement(We.a,{locale:Ve,dateFormat:"dd/mm/yy",showTime:!0,hourFormat:"24",value:this.state.date.endingDate,onChange:function(t){return e.onInputChange(t,"endingDate")}})))))}}]),t}(p.Component),Ke=(a(176),a(114)),qe=function(){function e(){Object(m.a)(this,e)}return Object(f.a)(e,[{key:"getTreeZones",value:function(){return w.a.get("https://cities-generator-service.vige.it:8743/cities")}},{key:"convert",value:function(e){var t=this;return e.map(function(e){return{key:e.id,data:e.id,label:e.name,icon:"pi pi-fw pi-cog",children:t.convert(e.zones)}})}}]),e}(),Xe=a(45),Ze=a.n(Xe),Qe=[{label:"Bigger",value:"bigger"},{label:"Bigger party groups",value:"bigger-partygroup"},{label:"Little",value:"little"},{label:"Little no groups",value:"little-nogroup"},{label:"Referendum",value:"referendum"}],$e="YYYY-MM-DDTHH:mm:ss",et=function(e){function t(){var e;return Object(m.a)(this,t),(e=Object(g.a)(this,Object(h.a)(t).call(this))).state={votingPaper:"",app:"",operation:"",dates:[{}],disjointed:!1,maxCandidates:0,color:"",type:"",zone:null,zones:null},e.zone=d.a.createRef(),e.zoneSelect=d.a.createRef(),e.datesRef=d.a.createRef(),e.state.configurationHeader=d.a.createElement(y.a,{id:"app.configuration.header",defaultMessage:"Configure your Voting Paper"}),e.state.configurationInsertHeader=d.a.createElement(y.a,{id:"app.configuration.insert.header",defaultMessage:"Add your Voting Paper"}),e.state.name=d.a.createElement(y.a,{id:"app.configuration.name",defaultMessage:"Name"}),e.state.startingDateLabel=d.a.createElement(y.a,{id:"app.configuration.startingdate",defaultMessage:"Starting date"}),e.state.endingDateLabel=d.a.createElement(y.a,{id:"app.configuration.endingdate",defaultMessage:"Ending date"}),e.state.disjointedLabel=d.a.createElement(y.a,{id:"app.configuration.disjointed",defaultMessage:"Disjointed vote"}),e.state.maxCandidatesLabel=d.a.createElement(y.a,{id:"app.configuration.maxcandidates",defaultMessage:"Candidates number"}),e.state.zoneLabel=d.a.createElement(y.a,{id:"app.configuration.zone",defaultMessage:"Zone"}),e.state.templatesLabel=d.a.createElement(y.a,{id:"app.configuration.templateslabel",defaultMessage:"Template Type"}),e.state.colorLabel=d.a.createElement(y.a,{id:"app.configuration.color",defaultMessage:"Voting Paper color"}),e.open=e.open.bind(Object(b.a)(Object(b.a)(e))),e.confirm=e.confirm.bind(Object(b.a)(Object(b.a)(e))),e.delete=e.delete.bind(Object(b.a)(Object(b.a)(e))),e.onHide=e.onHide.bind(Object(b.a)(Object(b.a)(e))),e.zoneService=new qe,e}return Object(v.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.zoneService.getTreeZones().then(function(t){e.setState({zones:e.zoneService.convert(t.data.zones)})})}},{key:"componentDidUpdate",value:function(){var e=this;if(this.state.app&&this.state.operation.startsWith("confirmed")){var t=V(this.state.app);if(this.setState({operation:""}),"confirmed_insert"===this.state.operation)t[t.length-3].click();else if("confirmed_update"===this.state.operation&&this.state.app.state.activeItem.id===this.state.votingPaper.value.id){var a=0;t.forEach(function(t,n){t.className.indexOf("-"+e.state.app.state.activeItem.id)>=0&&(a=n)}),t[a].click()}}}},{key:"open",value:function(){this.setState({visible:!0})}},{key:"confirm",value:function(){var e=this;if(me(this.state,ut.votingPapers)){if("update"===this.state.operation)ut.votingPapers.forEach(function(t){t.id===e.state.votingPaper.value.id&&(t.name=e.state.votingPaper.value.label,t.dates=e.datesRef.current.state.dates.map(function(e){return{startingDate:Ze()(e.startingDate).format($e),endingDate:Ze()(e.endingDate).format($e)}}),t.disjointed=e.state.disjointed,t.maxCandidates=e.state.maxCandidates,"little-nogroup"===e.state.type||"little"===e.state.type||"referendum"===e.state.type?t.zone=null:t.zone=e.state.zone,t.color=e.state.color,t.type=e.state.type)}),this.state.app.state.items.forEach(function(t){t.id===e.state.votingPaper.value.id&&(t.label=e.state.votingPaper.value.label)}),this.setState({visible:!1,operation:"confirmed_update"});else{var t,a,n=W(),i=this.state.zone;"little-nogroup"===this.state.type?a=[]:t=[],"little-nogroup"!==this.state.type&&"little"!==this.state.type&&"referendum"!==this.state.type||(i=null),ut.votingPapers.push({id:n,name:this.state.votingPaper.value.label,groups:t,parties:a,dates:this.datesRef.current.state.dates.map(function(e){return{startingDate:Ze()(e.startingDate).format($e),endingDate:Ze()(e.endingDate).format($e)}}),disjointed:this.state.disjointed,maxCandidates:this.state.maxCandidates,zone:i,color:this.state.color,type:this.state.type});var r=this.state.app.state.items.length-2;this.state.app.setState({items:B({id:n,label:this.state.votingPaper.value.label,icon:"pi pi-fw pi-briefcase"},r,this.state.app.state.items)}),this.setState({visible:!1,operation:"confirmed_insert"})}this.state.app.forceUpdate()}}},{key:"delete",value:function(){J(this.state.votingPaper.value,this.state.app),this.setState({visible:!1,operation:"confirmed_delete"})}},{key:"onHide",value:function(){this.setState({visible:!1})}},{key:"imgTemplate",value:function(e){var t="./template_images/"+e.value+".png";return d.a.createElement("div",{className:"p-clearfix"},d.a.createElement("img",{alt:e.label,src:t,style:{display:"inline-block",margin:"5px 0 0 5px",width:48}}),d.a.createElement("span",{style:{fontSize:"1em",float:"right",margin:"1em .5em 0 0"}},e.label))}},{key:"render",value:function(){var e=this,t=this.state.votingPaper.value,a="",n="grid",i="grid",r="grid";t&&"update"===this.state.operation&&(a=d.a.createElement(y.a,{id:"app.delete",defaultMessage:"Delete"},function(t){return d.a.createElement(E.a,{label:t[0],icon:"pi pi-check",onClick:e.delete,className:"confirm"})})),"little-nogroup"!==this.state.type&&"little"!==this.state.type&&"referendum"!==this.state.type||(n="grid disabled"),"referendum"===this.state.type&&(i="grid disabled",r="grid disabled");var s=d.a.createElement("div",{className:n,ref:this.zone},d.a.createElement("div",{className:"col"},this.state.zoneLabel),d.a.createElement("div",{className:"col"},d.a.createElement(y.a,{id:"app.configuration.choose.zone",defaultMessage:"Choose zone"},function(t){return d.a.createElement(Ke.a,{ref:e.zoneSelect,value:e.state.zone,options:e.state.zones,onChange:function(t){e.setState({zone:t.value})},filter:!0,placeholder:t[0]})}))),c=d.a.createElement("div",null,d.a.createElement(y.a,{id:"app.confirm",defaultMessage:"Confirm"},function(t){return d.a.createElement(E.a,{label:t[0],icon:"pi pi-check",onClick:e.confirm,className:"confirm"})}),a,d.a.createElement(y.a,{id:"app.cancel",defaultMessage:"Cancel"},function(t){return d.a.createElement(E.a,{label:t[0],icon:"pi pi-times",onClick:e.onHide,className:"p-button-secondary confirm"})})),l=this.state.configurationInsertHeader;"update"===this.state.operation&&(l=this.state.configurationHeader);var p=!1;"insert"!==this.state.operation||this.state.votingPaper.value||(p=!0);var u={autoFocus:p},m=d.a.createElement(pe.a,Object.assign({},u,{value:t?t.label:"",onChange:function(a){return e.setState({votingPaper:{value:{label:a.target.value,id:t?t.id:"",icon:"pi pi-fw pi-briefcase"}}})},onKeyPress:function(t){"Enter"===t.nativeEvent.key&&e.confirm()}}));return d.a.createElement(le.a,{contentStyle:{maxHeight:"620px",width:"360px"},header:l,visible:this.state.visible,footer:c,onHide:this.onHide,className:"modal-voting-paper"},d.a.createElement("div",{className:"grid"},d.a.createElement("div",{className:"col"},this.state.name),d.a.createElement("div",{className:"col"},m)),d.a.createElement("div",{className:r},d.a.createElement("div",{className:"col"},this.state.disjointedLabel),d.a.createElement("div",{className:"col"},d.a.createElement(He.a,{onChange:function(a){var n;(n=t)&&ne.filter(function(e){return e.votingPaper.id===n.id}).length>0&&(o({name:"name",message:d.a.createElement(y.a,{id:"app.admin.error.disjointed",defaultMessage:"You must deselect all votes of the voting paper before to change the disjointed vote '{name}'",values:{name:n.label}})}),1)||e.setState({disjointed:a.checked})},checked:this.state.disjointed}))),d.a.createElement("div",{className:i},d.a.createElement("div",{className:"col"},this.state.maxCandidatesLabel),d.a.createElement("div",{className:"col"},d.a.createElement(Ue.a,{showButtons:!0,onValueChange:function(t){return e.setState({maxCandidates:Number.isInteger(t.value)?parseInt(t.value,10):0})},value:this.state.maxCandidates,min:0,max:3}))),s,d.a.createElement("div",{className:"grid"},d.a.createElement("div",{className:"col"},this.state.colorLabel),d.a.createElement("div",{className:"col"},d.a.createElement(Ae.a,{value:this.state.color,onChange:function(t){return e.setState({color:t.value})}}))),d.a.createElement(Je,{ref:this.datesRef,dates:this.state.dates}),d.a.createElement("div",{className:"grid"},d.a.createElement("div",{className:"col"},this.state.templatesLabel)),d.a.createElement("div",{className:"grid"},d.a.createElement("div",{className:"col"},d.a.createElement(Ee.a,{value:this.state.type,filter:!0,options:Qe,onChange:function(t){t.value&&(e.setState({type:t.value}),"little-nogroup"===t.value||"little"===t.value||"referendum"===t.value?e.zone.current.className="grid disabled":e.zone.current.className="grid")},itemTemplate:this.imgTemplate,style:{width:"20.5em"},listStyle:{maxHeight:"250px"}}))))}}]),t}(p.Component),tt=a(106),at=(a(178),a(107)),nt=a.n(at),it=a(108),rt=a(109),st=a.n(rt),ot=a(110),ct=a.n(ot),lt=a(69),pt=a.n(lt),dt=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(g.a)(this,Object(h.a)(t).call(this,e)))._initStompClient=function(){a.client=ct.a.over(new st.a(a.props.url,null,a.props.options)),a.client.heartbeat.outgoing=a.props.heartbeat,a.client.heartbeat.incoming=a.props.heartbeat,Object.keys(a.props).includes("heartbeatIncoming")&&(a.client.heartbeat.incoming=a.props.heartbeatIncoming),Object.keys(a.props).includes("heartbeatOutgoing")&&(a.client.heartbeat.outgoing=a.props.heartbeatOutgoing),a.props.debug||(a.client.debug=function(){})},a._cleanUp=function(){a.setState({connected:!1}),a.retryCount=0,a.subscriptions.clear()},a._log=function(e){a.props.debug&&console.log(e)},a._subscribe=function(e){if(!a.subscriptions.has(e)){var t=a.client.subscribe(e,function(e){a.props.onMessage(a._processMessage(e.body),e.headers.destination)},a.props.subscribeHeaders);a.subscriptions.set(e,t)}},a._processMessage=function(e){try{return JSON.parse(e)}catch(t){return e}},a._unsubscribe=function(e){a.subscriptions.get(e).unsubscribe(),a.subscriptions.delete(e)},a._connect=function(){a._initStompClient(),a.client.connect(a.props.headers,function(){a.setState({connected:!0}),a.props.topics.forEach(function(e){a._subscribe(e)}),a.props.onConnect()},function(e){e&&(Object.keys(a.props).includes("onConnectFailure")?a.props.onConnectFailure(e):a._log(e.stack)),a.state.connected&&(a._cleanUp(),a.props.onDisconnect()),a.props.autoReconnect&&!a.state.explicitDisconnect&&(a._timeoutId=setTimeout(a._connect,a.props.getRetryInterval(a.retryCount++)))})},a.connect=function(){a.setState({explicitDisconnect:!1}),a.state.connected||a._connect()},a.disconnect=function(){a._timeoutId&&(clearTimeout(a._timeoutId),a._timeoutId=null),a.setState({explicitDisconnect:!0}),a.state.connected&&(a.subscriptions.forEach(function(e){a._unsubscribe(e)}),a.client.disconnect(function(){a._cleanUp(),a.props.onDisconnect(),a._log("Stomp client is successfully disconnected!")}))},a.sendMessage=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!a.state.connected)throw new Error("Send error: SockJsClient is disconnected");a.client.send(e,n,t)},a.state={connected:!1,explicitDisconnect:!1},a.subscriptions=new Map,a.retryCount=0,a}return Object(v.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){this._connect()}},{key:"componentWillUnmount",value:function(){this.disconnect()}},{key:"shouldComponentUpdate",value:function(){return!1}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this;this.state.connected&&(pt.a.difference(e.topics,this.props.topics).forEach(function(e){t._log("Subscribing to topic: "+e),t._subscribe(e)}),pt.a.difference(this.props.topics,e.topics).forEach(function(e){t._log("Unsubscribing from topic: "+e),t._unsubscribe(e)}))}},{key:"render",value:function(){return null}}]),t}(p.Component);dt.defaultProps={onConnect:function(){},onDisconnect:function(){},getRetryInterval:function(e){return 1e3*e},options:{},headers:{},subscribeHeaders:{},autoReconnect:!0,debug:!1,heartbeat:1e4};var ut,mt,ft=dt,gt=a(111),ht=function(e){function t(){var e;return Object(m.a)(this,t),(e=Object(g.a)(this,Object(h.a)(t).call(this))).state={items:[],visible:!0},mt=Object(b.a)(Object(b.a)(e)),e.modalVotingPaper=d.a.createRef(),e.confirm=d.a.createRef(),T.getProfile().then(function(e){T.axiosInstance.get("https://vota-votingpapers.vige.it:8543/votingPapers").then(function(t){(ut=t.data).profile=e,Y(mt)}).catch(function(e){console.log(e)})}).catch(function(){console.log("Failed to load user profile")}),e}return Object(v.a)(t,e),Object(f.a)(t,[{key:"componentDidUpdate",value:function(){if("created-tabs"===this.state.operation){var e=V(mt);e&&e[0]&&e[0].click(),this.setState({operation:void 0})}"websocket"===this.state.operation&&(V(this),this.setState({operation:void 0})),this.state.visible&&"PREPARE"!==ut.state&&function(){var e=ut.profile.attributes.stamps,t=!1;if(e){var a=new Date(e[e.length-1]);ut.votingPapers.forEach(function(e){e.dates.forEach(function(e){var n=new Date(e.startingDate),i=new Date(e.endingDate);n<=a&&i>=a&&(t=!0)})})}return t}()&&this.setState({visible:!1})}},{key:"render",value:function(){var e=this,t=d.a.createElement(_e,{ref:this.confirm,window:this}),a="",n="",i=d.a.createElement(ft,{url:"https://vota-votingpapers.vige.it:8543/votingpaper-websocket",topics:["/topic/votingpaper"],onMessage:function(t){if(t.state!==ut.state)window.location.reload();else{if(T.getProfile().then(function(e){ut.profile=e}).catch(function(){console.log("Failed to load user profile")}),t.votingPapers=t.votingPapers.filter(function(e){return function(e,t){return"PREPARE"===t.state?T.getRoles().includes("admin")||""!==L(parseInt(ut.profile.attributes.block[0],10),e):!e.zone||ut.profile.attributes.zones.includes(e.zone.toString())}(e,t)}),t.state===ut.state){ut.votingPapers.filter(function(e){return-1===t.votingPapers.map(function(e){return e.id}).indexOf(e.id)}).forEach(function(t){return J(t,e)}),t.votingPapers.forEach(function(t,a){var n=e.state.items[a];if(0===e.state.items.filter(function(e){return e.id===t.id}).length){ut.votingPapers.push(t);var i=e.state.items.length-2;e.setState({items:B({id:t.id,label:t.name,icon:"pi pi-fw pi-briefcase"},i,e.state.items)})}else if(n.id===t.id){n&&(n.label=t.name);var r=ut.votingPapers[a];r&&(r.type=t.type,r.dates=t.dates,r.disjointed=t.disjointed,r.color=t.color,r.maxCandidates=t.maxCandidates,r.zone=t.zone,r.name=t.name,function(e,t){var a=e.groups,n=t.groups;a&&n&&a.forEach(function(e){n.forEach(function(t){if(e.id===t.id){e.selected=t.selected;var a=e.parties,n=t.parties;a&&n&&a.forEach(function(e){n.forEach(function(t){if(e.id===t.id){e.selected=t.selected;var a=e.candidates,n=e.currentCandidates;a&&n&&a.forEach(function(e){n.forEach(function(t){e.id===t.id&&(e.selected=t.selected)})})}})})}})});var i=e.parties,r=t.parties;i&&r&&i.forEach(function(e){r.forEach(function(t){if(e.id===t.id){e.selected=t.selected;var a=e.candidates,n=e.currentCandidates;a&&n&&a.forEach(function(e){n.forEach(function(t){e.id===t.id&&(e.selected=t.selected)})})}})})}(t,r),r.groups=t.groups,r.parties=t.parties)}});var a=G(e),n=e.state.items.map(function(e){return e.id}).indexOf(e.state.activeItem.id);n>=0&&a[n].click()}ut.state=t.state,e.setState({operation:"websocket"})}}});return ut&&"PREPARE"===ut.state&&(t=d.a.createElement(Le,{ref:this.confirm,window:this}),a=d.a.createElement(et,{ref:this.modalVotingPaper}),n=d.a.createElement(ve,{ref:"ruler"})),ut?d.a.createElement("div",{className:"App"},i,d.a.createElement("div",{className:"content-section implementation"},d.a.createElement(ie,{ref:"validator"}),n,d.a.createElement(tt.a,{ref:"tabMenu",className:this.state.visible?"":"disabled",model:this.state.items,activeIndex:this.state.activeItem,onTabChange:function(t){if("PREPARE"===ut.state&&t.originalEvent.target.className.startsWith("p-menuitem-icon")){var a=function(e){if(e){var t="";return ut.votingPapers.forEach(function(a){a.id===e.id&&(t=a)}),t}return""}(t.value);e.modalVotingPaper.current.setState({votingPaper:t,app:e,operation:"update",dates:a.dates.map(function(e){return e.startingDate=new Date(e.startingDate),e.endingDate=new Date(e.endingDate),e}),disjointed:a.disjointed,maxCandidates:a.maxCandidates,zone:a.zone,color:a.color,type:a.type}),e.modalVotingPaper.current.open()}else e.state.visible&&(t.value.label===e.state.confirmButtonLabel?e.confirm.current.open():"+"===t.value.label?(e.modalVotingPaper.current.setState({votingPaper:"",app:e,operation:"insert",disjointed:!1,maxCandidates:0,zone:0,color:"1976D2",type:"bigger"}),e.modalVotingPaper.current.open()):e.setState({activeItem:t.value}))}}),a,t),ut&&ut.votingPapers.map(function(t){var a=d.a.createElement(y.a,{id:"app.confirm.confirmedheader",defaultMessage:"Your vote was sent!"}),n=d.a.createElement(y.a,{id:"app.confirm.confirmedbody",defaultMessage:"Your vote has been sent successfully. The results will be shown shortly. We thank you for your participation"});return d.a.createElement("header",{key:"header-"+t.id,className:"App-header "+t.type,ref:"header-"+t.id,style:t.name!==e.state.activeItem.label?{display:"none"}:{backgroundImage:"url(".concat(nt.a,")"),backgroundColor:"#"+t.color,borderColor:"#"+t.color}},d.a.createElement(De,{config:t,visible:e.state.visible,ref:"votingpaper-"+t.id}),d.a.createElement(it.a,{header:a,style:e.state.visible?{display:"none"}:{}},n))})):d.a.createElement(gt.a,null)}}]),t}(p.Component),vt=(a(213),a(215),a(217),a(219),a(221),a(226)),bt=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function yt(e,t){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See http://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}var Et={it:a(112)},kt=navigator.language.split(/[-_]/)[0],jt=Object(u.createRoot)(document.getElementById("root"));T.initKeycloak(function(){return jt.render(d.a.createElement(vt.a,{locale:kt,messages:Et[kt]},d.a.createElement(ht,null)))}),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="".concat("","/service-worker.js");bt?(function(e,t){fetch(e).then(function(a){var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):yt(e,t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit http://bit.ly/CRA-PWA")})):yt(t,e)})}}()}},[[118,2,1]]]);
//# sourceMappingURL=main.98fb2788.chunk.js.map